(()=>{var e={111:(e,t,a)=>{"use strict";a.r(t);const s=jQuery;var n=a.n(s);const i=wp.a11y,o=wp.i18n,r=new AudioContext,l=["audio/mpeg","video/ogg","audio/x-wav"],u=document.querySelector('input[type="file"]'),d=(e,t)=>{const a=p(e),s=t.map((e=>{let{error:t}=e;return t})).includes(!0),n=t.map((e=>{let{message:t}=e;return t}));a[0].innerHTML="<ul>"+t.reduce(((e,t)=>{let{error:a,message:s}=t;return`${e}<li class="${a?"error":"warning"}">${s}</li>`}),"")+"</ul>",(0,i.speak)(n.join(", ")),e.setCustomValidity(s?n.join(", "):""),e.reportValidity()},p=e=>n()(e).closest("div").siblings(".validation_message").length>0?n()(e).closest("div").siblings(".validation_message"):n()(e).siblings(".validation_message").length>0?n()(e).siblings(".validation_message"):n()('<div class="validation_message"></div>').insertAfter(e),m=async e=>{let{target:t}=e;const a=t.files[0],s=[],{name:n,size:i,type:u}=a;if(l.includes(u)||s.push({error:!0,message:(0,o.__)("File must be one of the allowed types: MP3, OGG, or WAV.","wikimedia-contest")}),i>1e8&&s.push({error:!0,message:(0,o.__)("File must be less than 100MB.","wikimedia-contest")}),s.length)return void d(t,s);const p=await a.arrayBuffer();try{const e=await r.decodeAudioData(p),{sampleRate:t,numberOfChannels:a,duration:l}=e;l>10?s.push({error:!0,message:(0,o.__)("Sound must be less than 10s.","wikimedia-contest")}):l<1?s.push({error:!0,message:(0,o.__)("Sound must be at least 1s.","wikimedia-contest")}):l>4&&s.push({error:!1,message:(0,o.__)("Sound should be less than 4s.","wikimedia-contest")});const d=32*t;"audio/mp3"===u&&d<196608?s.push({error:!1,message:(0,o.__)("MP3 files should be at least 192kbps.","wikimedia-contest")}):"video/ogg"===u&&d<163840&&s.push({error:!1,message:(0,o.__)("OGG files should be at least 160kbps.","wikimedia-contest")});const m=document.getElementById(window.audioFileMetaField);m&&(m.value=JSON.stringify({name:n,type:u,size:i,sampleRate:t,numberOfChannels:a,duration:l}))}catch(m){console.error(m),s.push({error:!0,message:(0,o.__)("Audio file is not readable.","wikimedia-contest")})}d(t,s)};document.addEventListener("DOMContentLoaded",(()=>{u&&u.addEventListener("change",m)}))},947:()=>{jQuery(document).ready((function(e){e("#submission-form").on("submit",(function(t){t.preventDefault();let a=e(this),s=new FormData;s.append("wiki_username",a.prop("wiki_username").value),s.append("legal_name",a.prop("legal_name").value),s.append("date_birth",a.prop("date_birth").value),s.append("participant_email",a.prop("participant_email").value),s.append("phone_number",a.prop("phone_number").value),s.append("authors_contributed",a.prop("authors_contributed").value),s.append("explanation_creation",a.prop("explanation_creation").value),s.append("explanation_inspiration",a.prop("explanation_inspiration").value);let n=a.prop("_submissionnonce").value;s.append("_submissionnonce",n);let i=submission_form_ajax_object.files_upload_nonce;s.append("_filesuploadnonce",i);let o=a.prop("audio_file").files[0];o&&(s.append("audio_file",o),s.append("audio_file_meta",JSON.stringify(a[0].querySelector('[type="file"]').soundMeta)));let r=submission_form_ajax_object.api_url,l=a.attr("method");e.ajax({url:r,type:l,data:s,contentType:!1,processData:!1,xhrFields:{withCredentials:!0},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",n)},success:function(t){t.success&&a.hide(),e("#submission_return_message").html(t.data.message)}})}))}))}},t={};function a(s){var n=t[s];if(void 0!==n)return n.exports;var i=t[s]={exports:{}};return e[s](i,i.exports,a),i.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a(111),a(947)})();