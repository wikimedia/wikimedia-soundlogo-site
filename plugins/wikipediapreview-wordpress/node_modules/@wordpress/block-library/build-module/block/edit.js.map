{"version":3,"sources":["@wordpress/block-library/src/block/edit.js"],"names":["useSelect","useDispatch","useEntityBlockEditor","useEntityProp","store","coreStore","Placeholder","Spinner","ToolbarGroup","ToolbarButton","TextControl","PanelBody","__","__experimentalUseInnerBlocksProps","useInnerBlocksProps","__experimentalUseNoRecursiveRenders","useNoRecursiveRenders","__experimentalBlockContentOverlay","BlockContentOverlay","InnerBlocks","BlockControls","InspectorControls","useBlockProps","Warning","reusableBlocksStore","ungroup","ReusableBlockEdit","attributes","ref","clientId","hasAlreadyRendered","RecursionProvider","isMissing","hasResolved","select","persistedBlock","getEntityRecord","hasResolvedBlock","hasFinishedResolution","__experimentalConvertBlockToStatic","convertBlockToStatic","blocks","onInput","onChange","id","title","setTitle","blockProps","innerBlocksProps","value","renderAppender","length","undefined","ButtonBlockAppender"],"mappings":";;AAAA;AACA;AACA;AACA,SAASA,SAAT,EAAoBC,WAApB,QAAuC,iBAAvC;AACA,SACCC,oBADD,EAECC,aAFD,EAGCC,KAAK,IAAIC,SAHV,QAIO,sBAJP;AAKA,SACCC,WADD,EAECC,OAFD,EAGCC,YAHD,EAICC,aAJD,EAKCC,WALD,EAMCC,SAND,QAOO,uBAPP;AAQA,SAASC,EAAT,QAAmB,iBAAnB;AACA,SACCC,iCAAiC,IAAIC,mBADtC,EAECC,mCAAmC,IAAIC,qBAFxC,EAGCC,iCAAiC,IAAIC,mBAHtC,EAICC,WAJD,EAKCC,aALD,EAMCC,iBAND,EAOCC,aAPD,EAQCC,OARD,QASO,yBATP;AAUA,SAASnB,KAAK,IAAIoB,mBAAlB,QAA6C,4BAA7C;AACA,SAASC,OAAT,QAAwB,kBAAxB;AAEA,eAAe,SAASC,iBAAT,CAA4B;AAAEC,EAAAA,UAAU,EAAE;AAAEC,IAAAA;AAAF,GAAd;AAAuBC,EAAAA;AAAvB,CAA5B,EAAgE;AAC9E,QAAM,CAAEC,kBAAF,EAAsBC,iBAAtB,IAA4Cf,qBAAqB,CACtEY,GADsE,CAAvE;AAGA,QAAM;AAAEI,IAAAA,SAAF;AAAaC,IAAAA;AAAb,MAA6BjC,SAAS,CACzCkC,MAAF,IAAc;AACb,UAAMC,cAAc,GAAGD,MAAM,CAAE7B,SAAF,CAAN,CAAoB+B,eAApB,CACtB,UADsB,EAEtB,UAFsB,EAGtBR,GAHsB,CAAvB;AAKA,UAAMS,gBAAgB,GAAGH,MAAM,CAC9B7B,SAD8B,CAAN,CAEvBiC,qBAFuB,CAEA,iBAFA,EAEmB,CAC3C,UAD2C,EAE3C,UAF2C,EAG3CV,GAH2C,CAFnB,CAAzB;AAOA,WAAO;AACNK,MAAAA,WAAW,EAAEI,gBADP;AAENL,MAAAA,SAAS,EAAEK,gBAAgB,IAAI,CAAEF;AAF3B,KAAP;AAIA,GAlB0C,EAmB3C,CAAEP,GAAF,EAAOC,QAAP,CAnB2C,CAA5C;AAsBA,QAAM;AACLU,IAAAA,kCAAkC,EAAEC;AAD/B,MAEFvC,WAAW,CAAEuB,mBAAF,CAFf;AAIA,QAAM,CAAEiB,MAAF,EAAUC,OAAV,EAAmBC,QAAnB,IAAgCzC,oBAAoB,CACzD,UADyD,EAEzD,UAFyD,EAGzD;AAAE0C,IAAAA,EAAE,EAAEhB;AAAN,GAHyD,CAA1D;AAKA,QAAM,CAAEiB,KAAF,EAASC,QAAT,IAAsB3C,aAAa,CACxC,UADwC,EAExC,UAFwC,EAGxC,OAHwC,EAIxCyB,GAJwC,CAAzC;AAOA,QAAMmB,UAAU,GAAGzB,aAAa,EAAhC;AAEA,QAAM0B,gBAAgB,GAAGlC,mBAAmB,CAC3C,EAD2C,EAE3C;AACCmC,IAAAA,KAAK,EAAER,MADR;AAECC,IAAAA,OAFD;AAGCC,IAAAA,QAHD;AAICO,IAAAA,cAAc,EAAET,MAAM,SAAN,IAAAA,MAAM,WAAN,IAAAA,MAAM,CAAEU,MAAR,GACbC,SADa,GAEbjC,WAAW,CAACkC;AANhB,GAF2C,CAA5C;;AAYA,MAAKvB,kBAAL,EAA0B;AACzB,WACC,qBAAUiB,UAAV,EACC,cAAC,OAAD,QACGnC,EAAE,CAAE,yCAAF,CADL,CADD,CADD;AAOA;;AAED,MAAKoB,SAAL,EAAiB;AAChB,WACC,qBAAUe,UAAV,EACC,cAAC,OAAD,QACGnC,EAAE,CAAE,2CAAF,CADL,CADD,CADD;AAOA;;AAED,MAAK,CAAEqB,WAAP,EAAqB;AACpB,WACC,qBAAUc,UAAV,EACC,cAAC,WAAD,QACC,cAAC,OAAD,OADD,CADD,CADD;AAOA;;AAED,SACC,cAAC,iBAAD,QACC,qBAAUA,UAAV,EACC,cAAC,aAAD,QACC,cAAC,YAAD,QACC,cAAC,aAAD;AACC,IAAA,OAAO,EAAG,MAAMP,oBAAoB,CAAEX,QAAF,CADrC;AAEC,IAAA,KAAK,EAAGjB,EAAE,CAAE,2BAAF,CAFX;AAGC,IAAA,IAAI,EAAGa,OAHR;AAIC,IAAA,WAAW;AAJZ,IADD,CADD,CADD,EAWC,cAAC,iBAAD,QACC,cAAC,SAAD,QACC,cAAC,WAAD;AACC,IAAA,KAAK,EAAGb,EAAE,CAAE,MAAF,CADX;AAEC,IAAA,KAAK,EAAGiC,KAFT;AAGC,IAAA,QAAQ,EAAGC;AAHZ,IADD,CADD,CAXD,EAoBC,cAAC,mBAAD;AACC,IAAA,QAAQ,EAAGjB,QADZ;AAEC,IAAA,YAAY,EAAGmB,gBAFhB;AAGC,IAAA,SAAS,EAAC;AAHX,IApBD,CADD,CADD;AA8BA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport {\n\tuseEntityBlockEditor,\n\tuseEntityProp,\n\tstore as coreStore,\n} from '@wordpress/core-data';\nimport {\n\tPlaceholder,\n\tSpinner,\n\tToolbarGroup,\n\tToolbarButton,\n\tTextControl,\n\tPanelBody,\n} from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport {\n\t__experimentalUseInnerBlocksProps as useInnerBlocksProps,\n\t__experimentalUseNoRecursiveRenders as useNoRecursiveRenders,\n\t__experimentalBlockContentOverlay as BlockContentOverlay,\n\tInnerBlocks,\n\tBlockControls,\n\tInspectorControls,\n\tuseBlockProps,\n\tWarning,\n} from '@wordpress/block-editor';\nimport { store as reusableBlocksStore } from '@wordpress/reusable-blocks';\nimport { ungroup } from '@wordpress/icons';\n\nexport default function ReusableBlockEdit( { attributes: { ref }, clientId } ) {\n\tconst [ hasAlreadyRendered, RecursionProvider ] = useNoRecursiveRenders(\n\t\tref\n\t);\n\tconst { isMissing, hasResolved } = useSelect(\n\t\t( select ) => {\n\t\t\tconst persistedBlock = select( coreStore ).getEntityRecord(\n\t\t\t\t'postType',\n\t\t\t\t'wp_block',\n\t\t\t\tref\n\t\t\t);\n\t\t\tconst hasResolvedBlock = select(\n\t\t\t\tcoreStore\n\t\t\t).hasFinishedResolution( 'getEntityRecord', [\n\t\t\t\t'postType',\n\t\t\t\t'wp_block',\n\t\t\t\tref,\n\t\t\t] );\n\t\t\treturn {\n\t\t\t\thasResolved: hasResolvedBlock,\n\t\t\t\tisMissing: hasResolvedBlock && ! persistedBlock,\n\t\t\t};\n\t\t},\n\t\t[ ref, clientId ]\n\t);\n\n\tconst {\n\t\t__experimentalConvertBlockToStatic: convertBlockToStatic,\n\t} = useDispatch( reusableBlocksStore );\n\n\tconst [ blocks, onInput, onChange ] = useEntityBlockEditor(\n\t\t'postType',\n\t\t'wp_block',\n\t\t{ id: ref }\n\t);\n\tconst [ title, setTitle ] = useEntityProp(\n\t\t'postType',\n\t\t'wp_block',\n\t\t'title',\n\t\tref\n\t);\n\n\tconst blockProps = useBlockProps();\n\n\tconst innerBlocksProps = useInnerBlocksProps(\n\t\t{},\n\t\t{\n\t\t\tvalue: blocks,\n\t\t\tonInput,\n\t\t\tonChange,\n\t\t\trenderAppender: blocks?.length\n\t\t\t\t? undefined\n\t\t\t\t: InnerBlocks.ButtonBlockAppender,\n\t\t}\n\t);\n\n\tif ( hasAlreadyRendered ) {\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<Warning>\n\t\t\t\t\t{ __( 'Block cannot be rendered inside itself.' ) }\n\t\t\t\t</Warning>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tif ( isMissing ) {\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<Warning>\n\t\t\t\t\t{ __( 'Block has been deleted or is unavailable.' ) }\n\t\t\t\t</Warning>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tif ( ! hasResolved ) {\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<Placeholder>\n\t\t\t\t\t<Spinner />\n\t\t\t\t</Placeholder>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<RecursionProvider>\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<BlockControls>\n\t\t\t\t\t<ToolbarGroup>\n\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\tonClick={ () => convertBlockToStatic( clientId ) }\n\t\t\t\t\t\t\tlabel={ __( 'Convert to regular blocks' ) }\n\t\t\t\t\t\t\ticon={ ungroup }\n\t\t\t\t\t\t\tshowTooltip\n\t\t\t\t\t\t/>\n\t\t\t\t\t</ToolbarGroup>\n\t\t\t\t</BlockControls>\n\t\t\t\t<InspectorControls>\n\t\t\t\t\t<PanelBody>\n\t\t\t\t\t\t<TextControl\n\t\t\t\t\t\t\tlabel={ __( 'Name' ) }\n\t\t\t\t\t\t\tvalue={ title }\n\t\t\t\t\t\t\tonChange={ setTitle }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</PanelBody>\n\t\t\t\t</InspectorControls>\n\t\t\t\t<BlockContentOverlay\n\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\twrapperProps={ innerBlocksProps }\n\t\t\t\t\tclassName=\"block-library-block__reusable-block-container\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</RecursionProvider>\n\t);\n}\n"]}