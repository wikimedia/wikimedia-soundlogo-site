{"version":3,"sources":["@wordpress/block-library/src/page-list/edit.js"],"names":["classnames","BlockControls","useBlockProps","store","blockEditorStore","getColorClassName","ServerSideRender","ToolbarButton","__","useEffect","useState","useSelect","apiFetch","addQueryArgs","ConvertToLinksModal","MAX_PAGE_COUNT","PageListEdit","context","clientId","attributes","setAttributes","textColor","customTextColor","backgroundColor","customBackgroundColor","overlayTextColor","customOverlayTextColor","overlayBackgroundColor","customOverlayBackgroundColor","style","allowConvertToLinks","setAllowConvertToLinks","blockProps","className","color","isParentNavigation","select","getBlockParentsByBlockName","length","isNavigationChild","openSubmenusOnClick","showSubmenuIcon","path","per_page","_fields","parse","then","res","headers","get","isOpen","setOpen","openModal","closeModal","attributesWithParentStatus"],"mappings":";;AAAA;AACA;AACA;AACA,OAAOA,UAAP,MAAuB,YAAvB;AAEA;AACA;AACA;;AACA,SACCC,aADD,EAECC,aAFD,EAGCC,KAAK,IAAIC,gBAHV,EAICC,iBAJD,QAKO,yBALP;AAMA,OAAOC,gBAAP,MAA6B,+BAA7B;AACA,SAASC,aAAT,QAA8B,uBAA9B;AACA,SAASC,EAAT,QAAmB,iBAAnB;AACA,SAASC,SAAT,EAAoBC,QAApB,QAAoC,oBAApC;AACA,SAASC,SAAT,QAA0B,iBAA1B;AACA,OAAOC,QAAP,MAAqB,sBAArB;AACA,SAASC,YAAT,QAA6B,gBAA7B;AAEA;AACA;AACA;;AACA,OAAOC,mBAAP,MAAgC,0BAAhC,C,CAEA;AACA;;AACA,MAAMC,cAAc,GAAG,GAAvB;AAEA,eAAe,SAASC,YAAT,CAAuB;AACrCC,EAAAA,OADqC;AAErCC,EAAAA,QAFqC;AAGrCC,EAAAA,UAHqC;AAIrCC,EAAAA;AAJqC,CAAvB,EAKX;AACH;AACA;AACAX,EAAAA,SAAS,CAAE,MAAM;AAChB,UAAM;AACLY,MAAAA,SADK;AAELC,MAAAA,eAFK;AAGLC,MAAAA,eAHK;AAILC,MAAAA,qBAJK;AAKLC,MAAAA,gBALK;AAMLC,MAAAA,sBANK;AAOLC,MAAAA,sBAPK;AAQLC,MAAAA;AARK,QASFX,OATJ;AAUAG,IAAAA,aAAa,CAAE;AACdC,MAAAA,SADc;AAEdC,MAAAA,eAFc;AAGdC,MAAAA,eAHc;AAIdC,MAAAA,qBAJc;AAKdC,MAAAA,gBALc;AAMdC,MAAAA,sBANc;AAOdC,MAAAA,sBAPc;AAQdC,MAAAA;AARc,KAAF,CAAb;AAUA,GArBQ,EAqBN,CACFX,OAAO,CAACI,SADN,EAEFJ,OAAO,CAACK,eAFN,EAGFL,OAAO,CAACM,eAHN,EAIFN,OAAO,CAACO,qBAJN,EAKFP,OAAO,CAACQ,gBALN,EAMFR,OAAO,CAACS,sBANN,EAOFT,OAAO,CAACU,sBAPN,EAQFV,OAAO,CAACW,4BARN,CArBM,CAAT;AAgCA,QAAM;AAAEP,IAAAA,SAAF;AAAaE,IAAAA,eAAb;AAA8BM,IAAAA;AAA9B,MAAwCZ,OAAO,IAAI,EAAzD;AAEA,QAAM,CAAEa,mBAAF,EAAuBC,sBAAvB,IAAkDrB,QAAQ,CAAE,KAAF,CAAhE;AAEA,QAAMsB,UAAU,GAAG9B,aAAa,CAAE;AACjC+B,IAAAA,SAAS,EAAEjC,UAAU,CAAE;AACtB,wBAAkB,CAAC,CAAEqB,SADC;AAEtB,OAAEhB,iBAAiB,CAAE,OAAF,EAAWgB,SAAX,CAAnB,GAA6C,CAAC,CAAEA,SAF1B;AAGtB,wBAAkB,CAAC,CAAEE,eAHC;AAItB,OAAElB,iBAAiB,CAClB,kBADkB,EAElBkB,eAFkB,CAAnB,GAGK,CAAC,CAAEA;AAPc,KAAF,CADY;AAUjCM,IAAAA,KAAK,EAAE,EAAE,IAAGA,KAAH,aAAGA,KAAH,uBAAGA,KAAK,CAAEK,KAAV;AAAF;AAV0B,GAAF,CAAhC;AAaA,QAAMC,kBAAkB,GAAGxB,SAAS,CACjCyB,MAAF,IAAc;AACb,UAAM;AAAEC,MAAAA;AAAF,QAAiCD,MAAM,CAAEhC,gBAAF,CAA7C;AACA,WACCiC,0BAA0B,CAAEnB,QAAF,EAAY,iBAAZ,CAA1B,CACEoB,MADF,GACW,CAFZ;AAIA,GAPkC,EAQnC,CAAEpB,QAAF,CARmC,CAApC;AAWAT,EAAAA,SAAS,CAAE,MAAM;AAChBW,IAAAA,aAAa,CAAE;AACdmB,MAAAA,iBAAiB,EAAEJ,kBADL;AAEdK,MAAAA,mBAAmB,EAAE,CAAC,CAAEvB,OAAO,CAACuB,mBAFlB;AAGdC,MAAAA,eAAe,EAAE,CAAC,CAAExB,OAAO,CAACwB;AAHd,KAAF,CAAb;AAKA,GANQ,EAMN,CAAExB,OAAO,CAACuB,mBAAV,EAA+BvB,OAAO,CAACwB,eAAvC,CANM,CAAT;AAQAhC,EAAAA,SAAS,CAAE,MAAM;AAChB,QAAK0B,kBAAL,EAA0B;AACzBvB,MAAAA,QAAQ,CAAE;AACT8B,QAAAA,IAAI,EAAE7B,YAAY,CAAE,cAAF,EAAkB;AACnC8B,UAAAA,QAAQ,EAAE,CADyB;AAEnCC,UAAAA,OAAO,EAAE,CAAE,IAAF;AAF0B,SAAlB,CADT;AAKTC,QAAAA,KAAK,EAAE;AALE,OAAF,CAAR,CAMIC,IANJ,CAMYC,GAAF,IAAW;AACpBhB,QAAAA,sBAAsB,CACrBgB,GAAG,CAACC,OAAJ,CAAYC,GAAZ,CAAiB,YAAjB,KAAmClC,cADd,CAAtB;AAGA,OAVD;AAWA,KAZD,MAYO;AACNgB,MAAAA,sBAAsB,CAAE,KAAF,CAAtB;AACA;AACD,GAhBQ,EAgBN,CAAEI,kBAAF,CAhBM,CAAT;AAkBA,QAAM,CAAEe,MAAF,EAAUC,OAAV,IAAsBzC,QAAQ,CAAE,KAAF,CAApC;;AACA,QAAM0C,SAAS,GAAG,MAAMD,OAAO,CAAE,IAAF,CAA/B;;AACA,QAAME,UAAU,GAAG,MAAMF,OAAO,CAAE,KAAF,CAAhC,CA3FG,CA6FH;;;AACA,QAAMG,0BAA0B,GAAG,EAClC,GAAGnC,UAD+B;AAElCoB,IAAAA,iBAAiB,EAAEJ,kBAFe;AAGlCK,IAAAA,mBAAmB,EAAE,CAAC,CAAEvB,OAAO,CAACuB,mBAHE;AAIlCC,IAAAA,eAAe,EAAE,CAAC,CAAExB,OAAO,CAACwB;AAJM,GAAnC;AAOA,SACC,8BACGX,mBAAmB,IACpB,cAAC,aAAD;AAAe,IAAA,KAAK,EAAC;AAArB,KACC,cAAC,aAAD;AAAe,IAAA,KAAK,EAAGtB,EAAE,CAAE,MAAF,CAAzB;AAAsC,IAAA,OAAO,EAAG4C;AAAhD,KACG5C,EAAE,CAAE,MAAF,CADL,CADD,CAFF,EAQGsB,mBAAmB,IAAIoB,MAAvB,IACD,cAAC,mBAAD;AACC,IAAA,OAAO,EAAGG,UADX;AAEC,IAAA,QAAQ,EAAGnC;AAFZ,IATF,EAcC,qBAAUc,UAAV,EACC,cAAC,gBAAD;AACC,IAAA,KAAK,EAAC,gBADP;AAEC,IAAA,UAAU,EAAGsB;AAFd,IADD,CAdD,CADD;AAuBA","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tBlockControls,\n\tuseBlockProps,\n\tstore as blockEditorStore,\n\tgetColorClassName,\n} from '@wordpress/block-editor';\nimport ServerSideRender from '@wordpress/server-side-render';\nimport { ToolbarButton } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { useEffect, useState } from '@wordpress/element';\nimport { useSelect } from '@wordpress/data';\nimport apiFetch from '@wordpress/api-fetch';\nimport { addQueryArgs } from '@wordpress/url';\n\n/**\n * Internal dependencies\n */\nimport ConvertToLinksModal from './convert-to-links-modal';\n\n// We only show the edit option when page count is <= MAX_PAGE_COUNT\n// Performance of Navigation Links is not good past this value.\nconst MAX_PAGE_COUNT = 100;\n\nexport default function PageListEdit( {\n\tcontext,\n\tclientId,\n\tattributes,\n\tsetAttributes,\n} ) {\n\t// Copy context to attributes to make it accessible in the editor's\n\t// ServerSideRender\n\tuseEffect( () => {\n\t\tconst {\n\t\t\ttextColor,\n\t\t\tcustomTextColor,\n\t\t\tbackgroundColor,\n\t\t\tcustomBackgroundColor,\n\t\t\toverlayTextColor,\n\t\t\tcustomOverlayTextColor,\n\t\t\toverlayBackgroundColor,\n\t\t\tcustomOverlayBackgroundColor,\n\t\t} = context;\n\t\tsetAttributes( {\n\t\t\ttextColor,\n\t\t\tcustomTextColor,\n\t\t\tbackgroundColor,\n\t\t\tcustomBackgroundColor,\n\t\t\toverlayTextColor,\n\t\t\tcustomOverlayTextColor,\n\t\t\toverlayBackgroundColor,\n\t\t\tcustomOverlayBackgroundColor,\n\t\t} );\n\t}, [\n\t\tcontext.textColor,\n\t\tcontext.customTextColor,\n\t\tcontext.backgroundColor,\n\t\tcontext.customBackgroundColor,\n\t\tcontext.overlayTextColor,\n\t\tcontext.customOverlayTextColor,\n\t\tcontext.overlayBackgroundColor,\n\t\tcontext.customOverlayBackgroundColor,\n\t] );\n\n\tconst { textColor, backgroundColor, style } = context || {};\n\n\tconst [ allowConvertToLinks, setAllowConvertToLinks ] = useState( false );\n\n\tconst blockProps = useBlockProps( {\n\t\tclassName: classnames( {\n\t\t\t'has-text-color': !! textColor,\n\t\t\t[ getColorClassName( 'color', textColor ) ]: !! textColor,\n\t\t\t'has-background': !! backgroundColor,\n\t\t\t[ getColorClassName(\n\t\t\t\t'background-color',\n\t\t\t\tbackgroundColor\n\t\t\t) ]: !! backgroundColor,\n\t\t} ),\n\t\tstyle: { ...style?.color },\n\t} );\n\n\tconst isParentNavigation = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getBlockParentsByBlockName } = select( blockEditorStore );\n\t\t\treturn (\n\t\t\t\tgetBlockParentsByBlockName( clientId, 'core/navigation' )\n\t\t\t\t\t.length > 0\n\t\t\t);\n\t\t},\n\t\t[ clientId ]\n\t);\n\n\tuseEffect( () => {\n\t\tsetAttributes( {\n\t\t\tisNavigationChild: isParentNavigation,\n\t\t\topenSubmenusOnClick: !! context.openSubmenusOnClick,\n\t\t\tshowSubmenuIcon: !! context.showSubmenuIcon,\n\t\t} );\n\t}, [ context.openSubmenusOnClick, context.showSubmenuIcon ] );\n\n\tuseEffect( () => {\n\t\tif ( isParentNavigation ) {\n\t\t\tapiFetch( {\n\t\t\t\tpath: addQueryArgs( '/wp/v2/pages', {\n\t\t\t\t\tper_page: 1,\n\t\t\t\t\t_fields: [ 'id' ],\n\t\t\t\t} ),\n\t\t\t\tparse: false,\n\t\t\t} ).then( ( res ) => {\n\t\t\t\tsetAllowConvertToLinks(\n\t\t\t\t\tres.headers.get( 'X-WP-Total' ) <= MAX_PAGE_COUNT\n\t\t\t\t);\n\t\t\t} );\n\t\t} else {\n\t\t\tsetAllowConvertToLinks( false );\n\t\t}\n\t}, [ isParentNavigation ] );\n\n\tconst [ isOpen, setOpen ] = useState( false );\n\tconst openModal = () => setOpen( true );\n\tconst closeModal = () => setOpen( false );\n\n\t// Update parent status before component first renders.\n\tconst attributesWithParentStatus = {\n\t\t...attributes,\n\t\tisNavigationChild: isParentNavigation,\n\t\topenSubmenusOnClick: !! context.openSubmenusOnClick,\n\t\tshowSubmenuIcon: !! context.showSubmenuIcon,\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t{ allowConvertToLinks && (\n\t\t\t\t<BlockControls group=\"other\">\n\t\t\t\t\t<ToolbarButton title={ __( 'Edit' ) } onClick={ openModal }>\n\t\t\t\t\t\t{ __( 'Edit' ) }\n\t\t\t\t\t</ToolbarButton>\n\t\t\t\t</BlockControls>\n\t\t\t) }\n\t\t\t{ allowConvertToLinks && isOpen && (\n\t\t\t\t<ConvertToLinksModal\n\t\t\t\t\tonClose={ closeModal }\n\t\t\t\t\tclientId={ clientId }\n\t\t\t\t/>\n\t\t\t) }\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<ServerSideRender\n\t\t\t\t\tblock=\"core/page-list\"\n\t\t\t\t\tattributes={ attributesWithParentStatus }\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</>\n\t);\n}\n"]}