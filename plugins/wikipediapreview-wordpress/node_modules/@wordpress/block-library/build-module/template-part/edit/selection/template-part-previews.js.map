{"version":3,"sources":["@wordpress/block-library/src/template-part/edit/selection/template-part-previews.js"],"names":["groupBy","deburr","flatten","useSelect","useDispatch","parse","useMemo","useCallback","ENTER","SPACE","__","sprintf","BlockPreview","__unstableComposite","Composite","__unstableCompositeItem","CompositeItem","Icon","__unstableUseCompositeState","useCompositeState","useAsyncList","store","noticesStore","coreStore","createTemplatePartId","getAreaGroupTitle","areaLabel","PreviewPlaceholder","TemplatePartItem","templatePart","setAttributes","onClose","composite","slug","theme","title","rendered","content","raw","blocks","createSuccessNotice","onClick","area","undefined","type","event","keyCode","PanelGroup","icon","children","TemplatePartsByArea","templateParts","labelsByArea","templatePartsByArea","templatePartsToShow","_templatePartsToShow","filter","_templatePartsByArea","Object","values","orderedTemplatePartsToShow","currentShownTPs","length","uncategorized","map","templatePartList","includes","id","TemplatePartSearchResults","filterValue","filteredTPs","groupedResults","normalizedFilterValue","toLowerCase","searchResults","sort","a","b","indexInTitleA","indexOf","indexInTitleB","_groupedResults","i","push","group","TemplatePartPreviews","templatePartId","select","_templateParts","getEntityRecords","per_page","definedAreas","__experimentalGetDefaultTemplatePartAreas","_labelsByArea","forEach","item","label"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { groupBy, deburr, flatten } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { parse } from '@wordpress/blocks';\nimport { useMemo, useCallback } from '@wordpress/element';\nimport { ENTER, SPACE } from '@wordpress/keycodes';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { BlockPreview } from '@wordpress/block-editor';\nimport {\n\t__unstableComposite as Composite,\n\t__unstableCompositeItem as CompositeItem,\n\tIcon,\n\t__unstableUseCompositeState as useCompositeState,\n} from '@wordpress/components';\nimport { useAsyncList } from '@wordpress/compose';\nimport { store as noticesStore } from '@wordpress/notices';\nimport { store as coreStore } from '@wordpress/core-data';\n\n/**\n * Internal dependencies\n */\nimport { createTemplatePartId } from '../utils/create-template-part-id';\n\nfunction getAreaGroupTitle( areaLabel ) {\n\treturn sprintf(\n\t\t// Translators: %s for the area the template part is assigned to (Header, Footer, General, etc.)\n\t\t__( 'Area: %s' ),\n\t\tareaLabel\n\t);\n}\nfunction PreviewPlaceholder() {\n\treturn (\n\t\t<div\n\t\t\tclassName=\"wp-block-template-part__selection-preview-item is-placeholder\"\n\t\t\ttabIndex={ 0 }\n\t\t/>\n\t);\n}\n\nfunction TemplatePartItem( {\n\ttemplatePart,\n\tsetAttributes,\n\tonClose,\n\tcomposite,\n} ) {\n\tconst {\n\t\tslug,\n\t\ttheme,\n\t\ttitle: { rendered: title },\n\t} = templatePart;\n\t// The 'raw' property is not defined for a brief period in the save cycle.\n\t// The fallback prevents an error in the parse function while saving.\n\tconst content = templatePart.content.raw || '';\n\tconst blocks = useMemo( () => parse( content ), [ content ] );\n\tconst { createSuccessNotice } = useDispatch( noticesStore );\n\n\tconst onClick = useCallback( () => {\n\t\tsetAttributes( { slug, theme, area: undefined } );\n\t\tcreateSuccessNotice(\n\t\t\tsprintf(\n\t\t\t\t/* translators: %s: template part title. */\n\t\t\t\t__( 'Template Part \"%s\" inserted.' ),\n\t\t\t\ttitle || slug\n\t\t\t),\n\t\t\t{\n\t\t\t\ttype: 'snackbar',\n\t\t\t}\n\t\t);\n\t\tonClose();\n\t}, [ slug, theme ] );\n\n\treturn (\n\t\t<CompositeItem\n\t\t\tas=\"div\"\n\t\t\tclassName=\"wp-block-template-part__selection-preview-item\"\n\t\t\trole=\"option\"\n\t\t\tonClick={ onClick }\n\t\t\tonKeyDown={ ( event ) => {\n\t\t\t\tif ( ENTER === event.keyCode || SPACE === event.keyCode ) {\n\t\t\t\t\tonClick();\n\t\t\t\t}\n\t\t\t} }\n\t\t\ttabIndex={ 0 }\n\t\t\taria-label={ title || slug }\n\t\t\t{ ...composite }\n\t\t>\n\t\t\t<BlockPreview blocks={ blocks } />\n\t\t\t<div className=\"wp-block-template-part__selection-preview-item-title\">\n\t\t\t\t{ title || slug }\n\t\t\t</div>\n\t\t</CompositeItem>\n\t);\n}\n\nfunction PanelGroup( { title, icon, children } ) {\n\treturn (\n\t\t<>\n\t\t\t<div className=\"wp-block-template-part__selection-panel-group-header\">\n\t\t\t\t<span className=\"wp-block-template-part__selection-panel-group-title\">\n\t\t\t\t\t{ title }\n\t\t\t\t</span>\n\t\t\t\t<Icon icon={ icon } />\n\t\t\t</div>\n\t\t\t<div className=\"wp-block-template-part__selection-panel-group-content\">\n\t\t\t\t{ children }\n\t\t\t</div>\n\t\t</>\n\t);\n}\n\nfunction TemplatePartsByArea( {\n\ttemplateParts,\n\tsetAttributes,\n\tonClose,\n\tcomposite,\n\tarea = 'uncategorized',\n\tlabelsByArea,\n} ) {\n\tconst { templatePartsByArea, templatePartsToShow } = useMemo( () => {\n\t\tconst _templatePartsToShow =\n\t\t\ttemplateParts.filter(\n\t\t\t\t( templatePart ) =>\n\t\t\t\t\t'uncategorized' === area || templatePart.area === area\n\t\t\t) || [];\n\t\tconst _templatePartsByArea = Object.values(\n\t\t\tgroupBy( _templatePartsToShow, 'area' )\n\t\t);\n\t\tconst orderedTemplatePartsToShow = flatten( _templatePartsToShow );\n\t\treturn {\n\t\t\ttemplatePartsByArea: _templatePartsByArea,\n\t\t\ttemplatePartsToShow: orderedTemplatePartsToShow,\n\t\t};\n\t}, [ templateParts, area ] );\n\n\tconst currentShownTPs = useAsyncList( templatePartsToShow );\n\n\tif ( ! templatePartsToShow.length ) {\n\t\treturn (\n\t\t\t<PanelGroup\n\t\t\t\ttitle={ getAreaGroupTitle(\n\t\t\t\t\tlabelsByArea[ area ] || labelsByArea.uncategorized\n\t\t\t\t) }\n\t\t\t>\n\t\t\t\t{ sprintf(\n\t\t\t\t\t// Translators: %s for the template part variation (\"Header\", \"Footer\", \"Template Part\").\n\t\t\t\t\t'There is no other %s available. If you are looking for another type of template part, try searching for it using the input above.',\n\t\t\t\t\tarea && area !== 'uncategorized'\n\t\t\t\t\t\t? labelsByArea[ area ] || area\n\t\t\t\t\t\t: __( 'Template Part' )\n\t\t\t\t) }\n\t\t\t</PanelGroup>\n\t\t);\n\t}\n\n\treturn templatePartsByArea.map( ( templatePartList ) => {\n\t\treturn (\n\t\t\t<PanelGroup\n\t\t\t\tkey={ templatePartList[ 0 ].area }\n\t\t\t\ttitle={ getAreaGroupTitle(\n\t\t\t\t\tlabelsByArea[ templatePartList[ 0 ].area ] ||\n\t\t\t\t\t\tlabelsByArea.uncategorized\n\t\t\t\t) }\n\t\t\t>\n\t\t\t\t{ templatePartList.map( ( templatePart ) => {\n\t\t\t\t\treturn currentShownTPs.includes( templatePart ) ? (\n\t\t\t\t\t\t<TemplatePartItem\n\t\t\t\t\t\t\tkey={ templatePart.id }\n\t\t\t\t\t\t\ttemplatePart={ templatePart }\n\t\t\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t\t\t\tonClose={ onClose }\n\t\t\t\t\t\t\tcomposite={ composite }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<PreviewPlaceholder key={ templatePart.id } />\n\t\t\t\t\t);\n\t\t\t\t} ) }\n\t\t\t</PanelGroup>\n\t\t);\n\t} );\n}\n\nfunction TemplatePartSearchResults( {\n\ttemplateParts,\n\tsetAttributes,\n\tfilterValue,\n\tonClose,\n\tcomposite,\n\tlabelsByArea,\n} ) {\n\tconst { filteredTPs, groupedResults } = useMemo( () => {\n\t\t// Filter based on value.\n\t\t// Remove diacritics and convert to lowercase to normalize.\n\t\tconst normalizedFilterValue = deburr( filterValue ).toLowerCase();\n\t\tconst searchResults = templateParts.filter(\n\t\t\t( { title: { rendered: title }, area } ) =>\n\t\t\t\tdeburr( title )\n\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t.includes( normalizedFilterValue ) ||\n\t\t\t\t// Since diacritics can be used in theme names, remove them for the comparison.\n\t\t\t\tdeburr( labelsByArea[ area ] )\n\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t.includes( normalizedFilterValue )\n\t\t);\n\t\t// Order based on value location.\n\t\tsearchResults.sort( ( a, b ) => {\n\t\t\t// First prioritize index found in title.\n\t\t\t// Deburr for diacritics.\n\t\t\tconst indexInTitleA = deburr( a.title.rendered )\n\t\t\t\t.toLowerCase()\n\t\t\t\t.indexOf( normalizedFilterValue );\n\t\t\tconst indexInTitleB = deburr( b.title.rendered )\n\t\t\t\t.toLowerCase()\n\t\t\t\t.indexOf( normalizedFilterValue );\n\t\t\tif ( indexInTitleA !== -1 && indexInTitleB !== -1 ) {\n\t\t\t\treturn indexInTitleA - indexInTitleB;\n\t\t\t} else if ( indexInTitleA !== -1 ) {\n\t\t\t\treturn -1;\n\t\t\t} else if ( indexInTitleB !== -1 ) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\t// Second prioritize index found in area.\n\t\t\treturn (\n\t\t\t\tdeburr( labelsByArea[ a.area ] )\n\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t.indexOf( normalizedFilterValue ) -\n\t\t\t\tdeburr( labelsByArea[ b.area ] )\n\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t.indexOf( normalizedFilterValue )\n\t\t\t);\n\t\t} );\n\t\t// Group filtered results together if their neighbors share the same area.\n\t\t// This helps not show redundant panel groups side by side in the results.\n\t\tconst _groupedResults = [];\n\t\tfor ( let i = 0; i < searchResults.length; i++ ) {\n\t\t\tif (\n\t\t\t\ti !== 0 &&\n\t\t\t\tsearchResults[ i ].area === searchResults[ i - 1 ].area\n\t\t\t) {\n\t\t\t\t_groupedResults[ _groupedResults.length - 1 ].push(\n\t\t\t\t\tsearchResults[ i ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\t_groupedResults.push( [ searchResults[ i ] ] );\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\tfilteredTPs: searchResults,\n\t\t\tgroupedResults: _groupedResults,\n\t\t};\n\t}, [ filterValue, templateParts ] );\n\n\tconst currentShownTPs = useAsyncList( filteredTPs );\n\n\treturn groupedResults.map( ( group ) => (\n\t\t<PanelGroup\n\t\t\tkey={ group[ 0 ].id }\n\t\t\ttitle={ getAreaGroupTitle(\n\t\t\t\tlabelsByArea[ group[ 0 ].area ] || labelsByArea.uncategorized\n\t\t\t) }\n\t\t>\n\t\t\t{ group.map( ( templatePart ) =>\n\t\t\t\tcurrentShownTPs.includes( templatePart ) ? (\n\t\t\t\t\t<TemplatePartItem\n\t\t\t\t\t\tkey={ templatePart.id }\n\t\t\t\t\t\ttemplatePart={ templatePart }\n\t\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t\t\tonClose={ onClose }\n\t\t\t\t\t\tcomposite={ composite }\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<PreviewPlaceholder key={ templatePart.id } />\n\t\t\t\t)\n\t\t\t) }\n\t\t</PanelGroup>\n\t) );\n}\n\nexport default function TemplatePartPreviews( {\n\tsetAttributes,\n\tfilterValue,\n\tonClose,\n\tarea,\n\ttemplatePartId,\n} ) {\n\tconst composite = useCompositeState();\n\n\tconst { templateParts, labelsByArea } = useSelect( ( select ) => {\n\t\tconst _templateParts = (\n\t\t\tselect( coreStore ).getEntityRecords(\n\t\t\t\t'postType',\n\t\t\t\t'wp_template_part',\n\t\t\t\t{\n\t\t\t\t\tper_page: -1,\n\t\t\t\t}\n\t\t\t) || []\n\t\t).filter(\n\t\t\t( templatePart ) =>\n\t\t\t\tcreateTemplatePartId(\n\t\t\t\t\ttemplatePart.theme,\n\t\t\t\t\ttemplatePart.slug\n\t\t\t\t) !== templatePartId\n\t\t);\n\n\t\t// FIXME: @wordpress/block-library should not depend on @wordpress/editor.\n\t\t// Blocks can be loaded into a *non-post* block editor.\n\t\t// eslint-disable-next-line @wordpress/data-no-store-string-literals\n\t\tconst definedAreas = select(\n\t\t\t'core/editor'\n\t\t).__experimentalGetDefaultTemplatePartAreas();\n\t\tconst _labelsByArea = {};\n\t\tdefinedAreas.forEach( ( item ) => {\n\t\t\t_labelsByArea[ item.area ] = item.label;\n\t\t} );\n\n\t\treturn {\n\t\t\ttemplateParts: _templateParts,\n\t\t\tlabelsByArea: _labelsByArea,\n\t\t};\n\t}, [] );\n\n\tif ( ! templateParts || ! templateParts.length ) {\n\t\treturn (\n\t\t\t<PanelGroup>\n\t\t\t\t{ __( 'There are no existing template parts to select.' ) }\n\t\t\t</PanelGroup>\n\t\t);\n\t}\n\n\tif ( filterValue ) {\n\t\treturn (\n\t\t\t<Composite\n\t\t\t\t{ ...composite }\n\t\t\t\trole=\"listbox\"\n\t\t\t\taria-label={ __( 'List of template parts' ) }\n\t\t\t>\n\t\t\t\t<TemplatePartSearchResults\n\t\t\t\t\ttemplateParts={ templateParts }\n\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t\tfilterValue={ filterValue }\n\t\t\t\t\tonClose={ onClose }\n\t\t\t\t\tcomposite={ composite }\n\t\t\t\t\tlabelsByArea={ labelsByArea }\n\t\t\t\t/>\n\t\t\t</Composite>\n\t\t);\n\t}\n\n\treturn (\n\t\t<Composite\n\t\t\t{ ...composite }\n\t\t\trole=\"listbox\"\n\t\t\taria-label={ __( 'List of template parts' ) }\n\t\t>\n\t\t\t<TemplatePartsByArea\n\t\t\t\ttemplateParts={ templateParts }\n\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\tonClose={ onClose }\n\t\t\t\tcomposite={ composite }\n\t\t\t\tarea={ area }\n\t\t\t\tlabelsByArea={ labelsByArea }\n\t\t\t/>\n\t\t</Composite>\n\t);\n}\n"]}