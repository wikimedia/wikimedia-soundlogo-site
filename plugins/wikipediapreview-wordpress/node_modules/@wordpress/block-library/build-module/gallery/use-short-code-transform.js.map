{"version":3,"sources":["@wordpress/block-library/src/gallery/use-short-code-transform.js"],"names":["every","useSelect","store","coreStore","useShortCodeTransform","shortCodeTransforms","newImageData","select","length","getMedia","map","image","imageData","id","type","url","source_url","mime","mime_type","alt","alt_text","link","undefined","img"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,KAAT,QAAsB,QAAtB;AAEA;AACA;AACA;;AACA,SAASC,SAAT,QAA0B,iBAA1B;AACA,SAASC,KAAK,IAAIC,SAAlB,QAAmC,sBAAnC;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,eAAe,SAASC,qBAAT,CAAgCC,mBAAhC,EAAsD;AACpE,QAAMC,YAAY,GAAGL,SAAS,CAC3BM,MAAF,IAAc;AACb,QAAK,CAAEF,mBAAF,IAAyBA,mBAAmB,CAACG,MAApB,KAA+B,CAA7D,EAAiE;AAChE;AACA;;AACD,UAAMC,QAAQ,GAAGF,MAAM,CAAEJ,SAAF,CAAN,CAAoBM,QAArC;AACA,WAAOJ,mBAAmB,CAACK,GAApB,CAA2BC,KAAF,IAAa;AAC5C,YAAMC,SAAS,GAAGH,QAAQ,CAAEE,KAAK,CAACE,EAAR,CAA1B;;AACA,UAAKD,SAAL,EAAiB;AAChB,eAAO;AACNC,UAAAA,EAAE,EAAED,SAAS,CAACC,EADR;AAENC,UAAAA,IAAI,EAAE,OAFA;AAGNC,UAAAA,GAAG,EAAEH,SAAS,CAACI,UAHT;AAINC,UAAAA,IAAI,EAAEL,SAAS,CAACM,SAJV;AAKNC,UAAAA,GAAG,EAAEP,SAAS,CAACQ,QALT;AAMNC,UAAAA,IAAI,EAAET,SAAS,CAACS;AANV,SAAP;AAQA;;AACD,aAAOC,SAAP;AACA,KAbM,CAAP;AAcA,GApB4B,EAqB7B,CAAEjB,mBAAF,CArB6B,CAA9B;;AAwBA,MAAK,CAAEC,YAAP,EAAsB;AACrB;AACA;;AAED,MAAKN,KAAK,CAAEM,YAAF,EAAkBiB,GAAF,IAAWA,GAAG,IAAIA,GAAG,CAACR,GAAtC,CAAV,EAAwD;AACvD,WAAOT,YAAP;AACA;AACD","sourcesContent":["/**\n * External dependencies\n */\nimport { every } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { useSelect } from '@wordpress/data';\nimport { store as coreStore } from '@wordpress/core-data';\n\n/**\n * Shortcode transforms don't currently have a tranform method and so can't use a selector to\n * retrieve the data for each image being transformer, so this selector handle this post transformation.\n *\n * @param {Array} shortCodeTransforms An array of image data passed from the shortcode transform.\n *\n * @return {Array} An array of extended image data objects for each of the shortcode transform images.\n */\nexport default function useShortCodeTransform( shortCodeTransforms ) {\n\tconst newImageData = useSelect(\n\t\t( select ) => {\n\t\t\tif ( ! shortCodeTransforms || shortCodeTransforms.length === 0 ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst getMedia = select( coreStore ).getMedia;\n\t\t\treturn shortCodeTransforms.map( ( image ) => {\n\t\t\t\tconst imageData = getMedia( image.id );\n\t\t\t\tif ( imageData ) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: imageData.id,\n\t\t\t\t\t\ttype: 'image',\n\t\t\t\t\t\turl: imageData.source_url,\n\t\t\t\t\t\tmime: imageData.mime_type,\n\t\t\t\t\t\talt: imageData.alt_text,\n\t\t\t\t\t\tlink: imageData.link,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t} );\n\t\t},\n\t\t[ shortCodeTransforms ]\n\t);\n\n\tif ( ! newImageData ) {\n\t\treturn;\n\t}\n\n\tif ( every( newImageData, ( img ) => img && img.url ) ) {\n\t\treturn newImageData;\n\t}\n}\n"]}