{"version":3,"sources":["@wordpress/block-library/src/gallery/gallery.js"],"names":["classnames","RichText","__experimentalUseInnerBlocksProps","useInnerBlocksProps","VisuallyHidden","useState","useEffect","__","createBlock","View","allowedBlocks","Gallery","props","attributes","isSelected","setAttributes","mediaPlaceholder","insertBlocksAfter","blockProps","align","columns","caption","imageCrop","children","innerBlocksProps","orientation","renderAppender","__experimentalLayout","type","alignments","captionFocused","setCaptionFocused","onFocusCaption","removeCaptionFocus","className","undefined","isEmpty","value","RichTextVisibilityHelper","isHidden","placeholder","tagName","captionRef","richTextProps"],"mappings":";;;AAAA;AACA;AACA;AACA,OAAOA,UAAP,MAAuB,YAAvB;AAEA;AACA;AACA;;AACA,SACCC,QADD,EAECC,iCAAiC,IAAIC,mBAFtC,QAGO,yBAHP;AAIA,SAASC,cAAT,QAA+B,uBAA/B;AACA,SAASC,QAAT,EAAmBC,SAAnB,QAAoC,oBAApC;AACA,SAASC,EAAT,QAAmB,iBAAnB;AACA,SAASC,WAAT,QAA4B,mBAA5B;AACA,SAASC,IAAT,QAAqB,uBAArB;AAEA,MAAMC,aAAa,GAAG,CAAE,YAAF,CAAtB;AAEA,OAAO,MAAMC,OAAO,GAAKC,KAAF,IAAa;AACnC,QAAM;AACLC,IAAAA,UADK;AAELC,IAAAA,UAFK;AAGLC,IAAAA,aAHK;AAILC,IAAAA,gBAJK;AAKLC,IAAAA,iBALK;AAMLC,IAAAA;AANK,MAOFN,KAPJ;AASA,QAAM;AAAEO,IAAAA,KAAF;AAASC,IAAAA,OAAT;AAAkBC,IAAAA,OAAlB;AAA2BC,IAAAA;AAA3B,MAAyCT,UAA/C;AAEA,QAAM;AAAEU,IAAAA,QAAF;AAAY,OAAGC;AAAf,MAAoCrB,mBAAmB,CAAEe,UAAF,EAAc;AAC1ER,IAAAA,aAD0E;AAE1Ee,IAAAA,WAAW,EAAE,YAF6D;AAG1EC,IAAAA,cAAc,EAAE,KAH0D;AAI1EC,IAAAA,oBAAoB,EAAE;AAAEC,MAAAA,IAAI,EAAE,SAAR;AAAmBC,MAAAA,UAAU,EAAE;AAA/B;AAJoD,GAAd,CAA7D;AAOA,QAAM,CAAEC,cAAF,EAAkBC,iBAAlB,IAAwC1B,QAAQ,CAAE,KAAF,CAAtD;;AAEA,WAAS2B,cAAT,GAA0B;AACzB,QAAK,CAAEF,cAAP,EAAwB;AACvBC,MAAAA,iBAAiB,CAAE,IAAF,CAAjB;AACA;AACD;;AAED,WAASE,kBAAT,GAA8B;AAC7B,QAAKH,cAAL,EAAsB;AACrBC,MAAAA,iBAAiB,CAAE,KAAF,CAAjB;AACA;AACD;;AAEDzB,EAAAA,SAAS,CAAE,MAAM;AAChB,QAAK,CAAEQ,UAAP,EAAoB;AACnBiB,MAAAA,iBAAiB,CAAE,KAAF,CAAjB;AACA;AACD,GAJQ,EAIN,CAAEjB,UAAF,CAJM,CAAT;AAMA,SACC,qCACMU,gBADN;AAEC,IAAA,SAAS,EAAGxB,UAAU,CACrBkB,UAAU,CAACgB,SADU,EAErB,qBAFqB,EAGrB;AACC,OAAG,QAAQf,KAAO,EAAlB,GAAuBA,KADxB;AAEC,OAAG,WAAWC,OAAS,EAAvB,GAA4BA,OAAO,KAAKe,SAFzC;AAGC,OAAG,iBAAH,GAAuBf,OAAO,KAAKe,SAHpC;AAIC,oBAAcb;AAJf,KAHqB;AAFvB,MAaGC,QAbH,EAeC,cAAC,IAAD;AACC,IAAA,SAAS,EAAC,0CADX;AAEC,IAAA,OAAO,EAAGU;AAFX,KAIGjB,gBAJH,CAfD,EAqBC,cAAC,wBAAD;AACC,IAAA,QAAQ,EAAG,CAAEF,UAAF,IAAgBb,QAAQ,CAACmC,OAAT,CAAkBf,OAAlB,CAD5B;AAEC,IAAA,cAAc,EAAGS,cAFlB;AAGC,IAAA,cAAc,EAAGE,cAHlB;AAIC,IAAA,OAAO,EAAC,YAJT;AAKC,IAAA,SAAS,EAAC,wBALX;AAMC,kBAAazB,EAAE,CAAE,sBAAF,CANhB;AAOC,IAAA,WAAW,EAAGA,EAAE,CAAE,wBAAF,CAPjB;AAQC,IAAA,KAAK,EAAGc,OART;AASC,IAAA,QAAQ,EAAKgB,KAAF,IAAatB,aAAa,CAAE;AAAEM,MAAAA,OAAO,EAAEgB;AAAX,KAAF,CATtC;AAUC,IAAA,aAAa,MAVd;AAWC,IAAA,sBAAsB,EAAG,MACxBpB,iBAAiB,CAAET,WAAW,CAAE,gBAAF,CAAb;AAZnB,IArBD,CADD;AAuCA,CA9EM;;AAgFP,SAAS8B,wBAAT,CAAmC;AAClCC,EAAAA,QADkC;AAElCT,EAAAA,cAFkC;AAGlCE,EAAAA,cAHkC;AAIlCE,EAAAA,SAJkC;AAKlCG,EAAAA,KALkC;AAMlCG,EAAAA,WANkC;AAOlCC,EAAAA,OAPkC;AAQlCC,EAAAA,UARkC;AASlC,KAAGC;AAT+B,CAAnC,EAUI;AACH,MAAKJ,QAAL,EAAgB;AACf,WAAO,cAAC,cAAD;AAAgB,MAAA,EAAE,EAAGtC;AAArB,OAAqC0C,aAArC,EAAP;AACA;;AAED,SACC,cAAC,QAAD;AACC,IAAA,GAAG,EAAGD,UADP;AAEC,IAAA,KAAK,EAAGL,KAFT;AAGC,IAAA,WAAW,EAAGG,WAHf;AAIC,IAAA,SAAS,EAAGN,SAJb;AAKC,IAAA,OAAO,EAAGO,OALX;AAMC,IAAA,UAAU,EAAGX,cANd;AAOC,IAAA,OAAO,EAAGE;AAPX,KAQMW,aARN,EADD;AAYA;;AAED,eAAehC,OAAf","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tRichText,\n\t__experimentalUseInnerBlocksProps as useInnerBlocksProps,\n} from '@wordpress/block-editor';\nimport { VisuallyHidden } from '@wordpress/components';\nimport { useState, useEffect } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { createBlock } from '@wordpress/blocks';\nimport { View } from '@wordpress/primitives';\n\nconst allowedBlocks = [ 'core/image' ];\n\nexport const Gallery = ( props ) => {\n\tconst {\n\t\tattributes,\n\t\tisSelected,\n\t\tsetAttributes,\n\t\tmediaPlaceholder,\n\t\tinsertBlocksAfter,\n\t\tblockProps,\n\t} = props;\n\n\tconst { align, columns, caption, imageCrop } = attributes;\n\n\tconst { children, ...innerBlocksProps } = useInnerBlocksProps( blockProps, {\n\t\tallowedBlocks,\n\t\torientation: 'horizontal',\n\t\trenderAppender: false,\n\t\t__experimentalLayout: { type: 'default', alignments: [] },\n\t} );\n\n\tconst [ captionFocused, setCaptionFocused ] = useState( false );\n\n\tfunction onFocusCaption() {\n\t\tif ( ! captionFocused ) {\n\t\t\tsetCaptionFocused( true );\n\t\t}\n\t}\n\n\tfunction removeCaptionFocus() {\n\t\tif ( captionFocused ) {\n\t\t\tsetCaptionFocused( false );\n\t\t}\n\t}\n\n\tuseEffect( () => {\n\t\tif ( ! isSelected ) {\n\t\t\tsetCaptionFocused( false );\n\t\t}\n\t}, [ isSelected ] );\n\n\treturn (\n\t\t<figure\n\t\t\t{ ...innerBlocksProps }\n\t\t\tclassName={ classnames(\n\t\t\t\tblockProps.className,\n\t\t\t\t'blocks-gallery-grid',\n\t\t\t\t{\n\t\t\t\t\t[ `align${ align }` ]: align,\n\t\t\t\t\t[ `columns-${ columns }` ]: columns !== undefined,\n\t\t\t\t\t[ `columns-default` ]: columns === undefined,\n\t\t\t\t\t'is-cropped': imageCrop,\n\t\t\t\t}\n\t\t\t) }\n\t\t>\n\t\t\t{ children }\n\n\t\t\t<View\n\t\t\t\tclassName=\"blocks-gallery-media-placeholder-wrapper\"\n\t\t\t\tonClick={ removeCaptionFocus }\n\t\t\t>\n\t\t\t\t{ mediaPlaceholder }\n\t\t\t</View>\n\t\t\t<RichTextVisibilityHelper\n\t\t\t\tisHidden={ ! isSelected && RichText.isEmpty( caption ) }\n\t\t\t\tcaptionFocused={ captionFocused }\n\t\t\t\tonFocusCaption={ onFocusCaption }\n\t\t\t\ttagName=\"figcaption\"\n\t\t\t\tclassName=\"blocks-gallery-caption\"\n\t\t\t\taria-label={ __( 'Gallery caption text' ) }\n\t\t\t\tplaceholder={ __( 'Write gallery captionâ€¦' ) }\n\t\t\t\tvalue={ caption }\n\t\t\t\tonChange={ ( value ) => setAttributes( { caption: value } ) }\n\t\t\t\tinlineToolbar\n\t\t\t\t__unstableOnSplitAtEnd={ () =>\n\t\t\t\t\tinsertBlocksAfter( createBlock( 'core/paragraph' ) )\n\t\t\t\t}\n\t\t\t/>\n\t\t</figure>\n\t);\n};\n\nfunction RichTextVisibilityHelper( {\n\tisHidden,\n\tcaptionFocused,\n\tonFocusCaption,\n\tclassName,\n\tvalue,\n\tplaceholder,\n\ttagName,\n\tcaptionRef,\n\t...richTextProps\n} ) {\n\tif ( isHidden ) {\n\t\treturn <VisuallyHidden as={ RichText } { ...richTextProps } />;\n\t}\n\n\treturn (\n\t\t<RichText\n\t\t\tref={ captionRef }\n\t\t\tvalue={ value }\n\t\t\tplaceholder={ placeholder }\n\t\t\tclassName={ className }\n\t\t\ttagName={ tagName }\n\t\t\tisSelected={ captionFocused }\n\t\t\tonClick={ onFocusCaption }\n\t\t\t{ ...richTextProps }\n\t\t/>\n\t);\n}\n\nexport default Gallery;\n"]}