{"version":3,"sources":["@wordpress/block-library/src/gallery/v1/update-gallery-modal.js"],"names":["Button","Modal","__","useDispatch","useSelect","createBlock","store","blockEditorStore","LINK_DESTINATION_ATTACHMENT","LINK_DESTINATION_NONE","LINK_DESTINATION_MEDIA","updateGallery","clientId","getBlock","replaceBlocks","link","attributes","sizeSlug","linkTo","images","caption","innerBlocks","map","image","id","parseInt","url","alt","linkDestination","UpdateGalleryModal","onClose","describedby"],"mappings":";;AAAA;AACA;AACA;AACA,SAASA,MAAT,EAAiBC,KAAjB,QAA8B,uBAA9B;AACA,SAASC,EAAT,QAAmB,iBAAnB;AACA,SAASC,WAAT,EAAsBC,SAAtB,QAAuC,iBAAvC;AACA,SAASC,WAAT,QAA4B,mBAA5B;AACA,SAASC,KAAK,IAAIC,gBAAlB,QAA0C,yBAA1C;AAEA;AACA;AACA;;AACA,SACCC,2BADD,EAECC,qBAFD,EAGCC,sBAHD,QAIO,aAJP;AAMA,OAAO,MAAMC,aAAa,GAAG,CAAE;AAC9BC,EAAAA,QAD8B;AAE9BC,EAAAA,QAF8B;AAG9BC,EAAAA;AAH8B,CAAF,KAItB,MAAM;AACZ,MAAIC,IAAJ;AACA,QAAM;AACLC,IAAAA,UAAU,EAAE;AAAEC,MAAAA,QAAF;AAAYC,MAAAA,MAAZ;AAAoBC,MAAAA,MAApB;AAA4BC,MAAAA;AAA5B;AADP,MAEFP,QAAQ,CAAED,QAAF,CAFZ;;AAIA,UAASM,MAAT;AACC,SAAK,MAAL;AACCH,MAAAA,IAAI,GAAGP,2BAAP;AACA;;AACD,SAAK,MAAL;AACCO,MAAAA,IAAI,GAAGL,sBAAP;AACA;;AACD;AACCK,MAAAA,IAAI,GAAGN,qBAAP;AACA;AATF;;AAWA,QAAMY,WAAW,GAAGF,MAAM,CAACG,GAAP,CAAcC,KAAF,IAC/BlB,WAAW,CAAE,YAAF,EAAgB;AAC1BmB,IAAAA,EAAE,EAAEC,QAAQ,CAAEF,KAAK,CAACC,EAAR,EAAY,EAAZ,CADc;AAE1BE,IAAAA,GAAG,EAAEH,KAAK,CAACG,GAFe;AAG1BC,IAAAA,GAAG,EAAEJ,KAAK,CAACI,GAHe;AAI1BP,IAAAA,OAAO,EAAEG,KAAK,CAACH,OAJW;AAK1BQ,IAAAA,eAAe,EAAEb;AALS,GAAhB,CADQ,CAApB;AAUAD,EAAAA,aAAa,CACZF,QADY,EAEZP,WAAW,CACV,cADU,EAEV;AAAEY,IAAAA,QAAF;AAAYC,IAAAA,MAAM,EAAEH,IAApB;AAA0BK,IAAAA;AAA1B,GAFU,EAGVC,WAHU,CAFC,CAAb;AAQA,CAvCM;AAyCP,eAAe,SAASQ,kBAAT,CAA6B;AAAEC,EAAAA,OAAF;AAAWlB,EAAAA;AAAX,CAA7B,EAAqD;AACnE,QAAM;AAAEC,IAAAA;AAAF,MAAeT,SAAS,CAAEG,gBAAF,CAA9B;AACA,QAAM;AAAEO,IAAAA;AAAF,MAAoBX,WAAW,CAAEI,gBAAF,CAArC;AACA,SACC,cAAC,KAAD;AACC,IAAA,UAAU,EAAGL,EAAE,CAAE,OAAF,CADhB;AAEC,IAAA,cAAc,EAAG4B,OAFlB;AAGC,IAAA,KAAK,EAAG5B,EAAE,CAAE,gBAAF,CAHX;AAIC,IAAA,SAAS,EAAG,+BAJb;AAKC,IAAA,IAAI,EAAG;AACN6B,MAAAA,WAAW,EAAE;AADP;AALR,KASC;AAAG,IAAA,EAAE,EAAG;AAAR,KACG7B,EAAE,CACH,gKADG,CADL,CATD,EAeC;AAAK,IAAA,SAAS,EAAC;AAAf,KACC,cAAC,MAAD;AAAQ,IAAA,UAAU,MAAlB;AAAmB,IAAA,OAAO,EAAG4B;AAA7B,KACG5B,EAAE,CAAE,QAAF,CADL,CADD,EAIC,cAAC,MAAD;AACC,IAAA,SAAS,MADV;AAEC,IAAA,OAAO,EAAGS,aAAa,CAAE;AACxBG,MAAAA,aADwB;AAExBD,MAAAA,QAFwB;AAGxBD,MAAAA,QAHwB;AAIxBP,MAAAA;AAJwB,KAAF;AAFxB,KASGH,EAAE,CAAE,QAAF,CATL,CAJD,CAfD,CADD;AAkCA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Button, Modal } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { createBlock } from '@wordpress/blocks';\nimport { store as blockEditorStore } from '@wordpress/block-editor';\n\n/**\n * Internal dependencies\n */\nimport {\n\tLINK_DESTINATION_ATTACHMENT,\n\tLINK_DESTINATION_NONE,\n\tLINK_DESTINATION_MEDIA,\n} from './constants';\n\nexport const updateGallery = ( {\n\tclientId,\n\tgetBlock,\n\treplaceBlocks,\n} ) => () => {\n\tlet link;\n\tconst {\n\t\tattributes: { sizeSlug, linkTo, images, caption },\n\t} = getBlock( clientId );\n\n\tswitch ( linkTo ) {\n\t\tcase 'post':\n\t\t\tlink = LINK_DESTINATION_ATTACHMENT;\n\t\t\tbreak;\n\t\tcase 'file':\n\t\t\tlink = LINK_DESTINATION_MEDIA;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tlink = LINK_DESTINATION_NONE;\n\t\t\tbreak;\n\t}\n\tconst innerBlocks = images.map( ( image ) =>\n\t\tcreateBlock( 'core/image', {\n\t\t\tid: parseInt( image.id, 10 ),\n\t\t\turl: image.url,\n\t\t\talt: image.alt,\n\t\t\tcaption: image.caption,\n\t\t\tlinkDestination: link,\n\t\t} )\n\t);\n\n\treplaceBlocks(\n\t\tclientId,\n\t\tcreateBlock(\n\t\t\t'core/gallery',\n\t\t\t{ sizeSlug, linkTo: link, caption },\n\t\t\tinnerBlocks\n\t\t)\n\t);\n};\n\nexport default function UpdateGalleryModal( { onClose, clientId } ) {\n\tconst { getBlock } = useSelect( blockEditorStore );\n\tconst { replaceBlocks } = useDispatch( blockEditorStore );\n\treturn (\n\t\t<Modal\n\t\t\tcloseLabel={ __( 'Close' ) }\n\t\t\tonRequestClose={ onClose }\n\t\t\ttitle={ __( 'Update gallery' ) }\n\t\t\tclassName={ 'wp-block-update-gallery-modal' }\n\t\t\taria={ {\n\t\t\t\tdescribedby: 'wp-block-update-gallery-modal__description',\n\t\t\t} }\n\t\t>\n\t\t\t<p id={ 'wp-block-update-gallery-modal__description' }>\n\t\t\t\t{ __(\n\t\t\t\t\t'Updating to the new format adds the ability to use custom links or styles on individual images in the gallery, and makes it easier to add or move them around.'\n\t\t\t\t) }\n\t\t\t</p>\n\n\t\t\t<div className=\"wp-block-update-gallery-modal-buttons\">\n\t\t\t\t<Button isTertiary onClick={ onClose }>\n\t\t\t\t\t{ __( 'Cancel' ) }\n\t\t\t\t</Button>\n\t\t\t\t<Button\n\t\t\t\t\tisPrimary\n\t\t\t\t\tonClick={ updateGallery( {\n\t\t\t\t\t\treplaceBlocks,\n\t\t\t\t\t\tgetBlock,\n\t\t\t\t\t\tclientId,\n\t\t\t\t\t\tcreateBlock,\n\t\t\t\t\t} ) }\n\t\t\t\t>\n\t\t\t\t\t{ __( 'Update' ) }\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t</Modal>\n\t);\n}\n"]}