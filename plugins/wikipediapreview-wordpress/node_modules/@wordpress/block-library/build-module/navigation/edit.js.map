{"version":3,"sources":["@wordpress/block-library/src/navigation/edit.js"],"names":["classnames","useState","useEffect","useMemo","useRef","Platform","__experimentalUseInnerBlocksProps","useInnerBlocksProps","InspectorControls","JustifyToolbar","BlockControls","useBlockProps","store","blockEditorStore","withColors","PanelColorSettings","ContrastChecker","getColorClassName","useDispatch","withSelect","withDispatch","PanelBody","ToggleControl","ToolbarGroup","compose","__","useBlockNavigator","NavigationPlaceholder","PlaceholderPreview","ResponsiveWrapper","ALLOWED_BLOCKS","DEFAULT_BLOCK","DIRECT_INSERT","block","innerBlocks","every","name","LAYOUT","type","alignments","getComputedStyle","node","ownerDocument","defaultView","detectColors","colorsDetectionElement","setColor","setBackground","color","backgroundColorNode","backgroundColor","parentNode","nodeType","ELEMENT_NODE","Navigation","selectedBlockHasDescendants","attributes","setAttributes","clientId","hasExistingNavItems","isImmediateParentOfSelectedBlock","isSelected","updateInnerBlocks","className","setBackgroundColor","textColor","setTextColor","overlayBackgroundColor","setOverlayBackgroundColor","overlayTextColor","setOverlayTextColor","hasSubmenuIndicatorSetting","hasItemJustificationControls","hasColorSettings","customPlaceholder","CustomPlaceholder","customAppender","CustomAppender","isPlaceholderShown","setIsPlaceholderShown","isResponsiveMenuOpen","setResponsiveMenuVisibility","selectBlock","navRef","blockProps","ref","itemsJustification","orientation","isResponsive","class","slug","style","navigatorToolbarButton","navigatorModal","placeholder","appender","undefined","innerBlocksProps","allowedBlocks","__experimentalDefaultBlock","__experimentalDirectInsert","renderAppender","__experimentalCaptureToolbars","templateLock","__experimentalLayout","enableContrastChecking","OS","detectedBackgroundColor","setDetectedBackgroundColor","detectedColor","setDetectedColor","detectedOverlayBackgroundColor","setDetectedOverlayBackgroundColor","detectedOverlayColor","setDetectedOverlayColor","current","subMenuElement","querySelector","PlaceholderComponent","blocks","selectNavigationBlock","justifyAllowedControls","value","position","isAlternate","openSubmenusOnClick","showSubmenuIcon","onChange","label","select","getBlocks","getClientIdsOfDescendants","hasSelectedInnerBlock","getSelectedBlockClientId","selectedBlockId","length","dispatch","replaceInnerBlocks"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tuseState,\n\tuseEffect,\n\tuseMemo,\n\tuseRef,\n\tPlatform,\n} from '@wordpress/element';\nimport {\n\t__experimentalUseInnerBlocksProps as useInnerBlocksProps,\n\tInspectorControls,\n\tJustifyToolbar,\n\tBlockControls,\n\tuseBlockProps,\n\tstore as blockEditorStore,\n\twithColors,\n\tPanelColorSettings,\n\tContrastChecker,\n\tgetColorClassName,\n} from '@wordpress/block-editor';\nimport { useDispatch, withSelect, withDispatch } from '@wordpress/data';\nimport { PanelBody, ToggleControl, ToolbarGroup } from '@wordpress/components';\nimport { compose } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport useBlockNavigator from './use-block-navigator';\nimport NavigationPlaceholder from './placeholder';\nimport PlaceholderPreview from './placeholder-preview';\nimport ResponsiveWrapper from './responsive-wrapper';\n\nconst ALLOWED_BLOCKS = [\n\t'core/navigation-link',\n\t'core/search',\n\t'core/social-links',\n\t'core/page-list',\n\t'core/spacer',\n\t'core/home-link',\n\t'core/site-title',\n\t'core/site-logo',\n\t'core/navigation-submenu',\n];\n\nconst DEFAULT_BLOCK = [ 'core/navigation-link' ];\n\nconst DIRECT_INSERT = ( block ) => {\n\treturn block.innerBlocks.every(\n\t\t( { name } ) =>\n\t\t\tname === 'core/navigation-link' ||\n\t\t\tname === 'core/navigation-submenu'\n\t);\n};\n\nconst LAYOUT = {\n\ttype: 'default',\n\talignments: [],\n};\n\nfunction getComputedStyle( node ) {\n\treturn node.ownerDocument.defaultView.getComputedStyle( node );\n}\n\nfunction detectColors( colorsDetectionElement, setColor, setBackground ) {\n\tif ( ! colorsDetectionElement ) {\n\t\treturn;\n\t}\n\tsetColor( getComputedStyle( colorsDetectionElement ).color );\n\n\tlet backgroundColorNode = colorsDetectionElement;\n\tlet backgroundColor = getComputedStyle( backgroundColorNode )\n\t\t.backgroundColor;\n\twhile (\n\t\tbackgroundColor === 'rgba(0, 0, 0, 0)' &&\n\t\tbackgroundColorNode.parentNode &&\n\t\tbackgroundColorNode.parentNode.nodeType ===\n\t\t\tbackgroundColorNode.parentNode.ELEMENT_NODE\n\t) {\n\t\tbackgroundColorNode = backgroundColorNode.parentNode;\n\t\tbackgroundColor = getComputedStyle( backgroundColorNode )\n\t\t\t.backgroundColor;\n\t}\n\n\tsetBackground( backgroundColor );\n}\n\nfunction Navigation( {\n\tselectedBlockHasDescendants,\n\tattributes,\n\tsetAttributes,\n\tclientId,\n\thasExistingNavItems,\n\tisImmediateParentOfSelectedBlock,\n\tisSelected,\n\tupdateInnerBlocks,\n\tclassName,\n\tbackgroundColor,\n\tsetBackgroundColor,\n\ttextColor,\n\tsetTextColor,\n\toverlayBackgroundColor,\n\tsetOverlayBackgroundColor,\n\toverlayTextColor,\n\tsetOverlayTextColor,\n\n\t// These props are used by the navigation editor to override specific\n\t// navigation block settings.\n\thasSubmenuIndicatorSetting = true,\n\thasItemJustificationControls = true,\n\thasColorSettings = true,\n\tcustomPlaceholder: CustomPlaceholder = null,\n\tcustomAppender: CustomAppender = null,\n} ) {\n\tconst [ isPlaceholderShown, setIsPlaceholderShown ] = useState(\n\t\t! hasExistingNavItems\n\t);\n\tconst [ isResponsiveMenuOpen, setResponsiveMenuVisibility ] = useState(\n\t\tfalse\n\t);\n\n\tconst { selectBlock } = useDispatch( blockEditorStore );\n\n\tconst navRef = useRef();\n\n\tconst blockProps = useBlockProps( {\n\t\tref: navRef,\n\t\tclassName: classnames( className, {\n\t\t\t[ `items-justified-${ attributes.itemsJustification }` ]: attributes.itemsJustification,\n\t\t\t'is-vertical': attributes.orientation === 'vertical',\n\t\t\t'is-responsive': attributes.isResponsive,\n\t\t\t'has-text-color': !! textColor.color || !! textColor?.class,\n\t\t\t[ getColorClassName(\n\t\t\t\t'color',\n\t\t\t\ttextColor?.slug\n\t\t\t) ]: !! textColor?.slug,\n\t\t\t'has-background': !! backgroundColor.color || backgroundColor.class,\n\t\t\t[ getColorClassName(\n\t\t\t\t'background-color',\n\t\t\t\tbackgroundColor?.slug\n\t\t\t) ]: !! backgroundColor?.slug,\n\t\t} ),\n\t\tstyle: {\n\t\t\tcolor: ! textColor?.slug && textColor?.color,\n\t\t\tbackgroundColor: ! backgroundColor?.slug && backgroundColor?.color,\n\t\t},\n\t} );\n\n\tconst { navigatorToolbarButton, navigatorModal } = useBlockNavigator(\n\t\tclientId\n\t);\n\n\tconst placeholder = useMemo( () => <PlaceholderPreview />, [] );\n\n\t// When the block is selected itself or has a top level item selected that\n\t// doesn't itself have children, show the standard appender. Else show no\n\t// appender.\n\tconst appender =\n\t\tisSelected ||\n\t\t( isImmediateParentOfSelectedBlock && ! selectedBlockHasDescendants )\n\t\t\t? undefined\n\t\t\t: false;\n\n\tconst innerBlocksProps = useInnerBlocksProps(\n\t\t{\n\t\t\tclassName: 'wp-block-navigation__container',\n\t\t},\n\t\t{\n\t\t\tallowedBlocks: ALLOWED_BLOCKS,\n\t\t\t__experimentalDefaultBlock: DEFAULT_BLOCK,\n\t\t\t__experimentalDirectInsert: DIRECT_INSERT,\n\t\t\torientation: attributes.orientation,\n\t\t\trenderAppender: CustomAppender || appender,\n\n\t\t\t// Ensure block toolbar is not too far removed from item\n\t\t\t// being edited when in vertical mode.\n\t\t\t// see: https://github.com/WordPress/gutenberg/pull/34615.\n\t\t\t__experimentalCaptureToolbars:\n\t\t\t\tattributes.orientation !== 'vertical',\n\t\t\t// Template lock set to false here so that the Nav\n\t\t\t// Block on the experimental menus screen does not\n\t\t\t// inherit templateLock={ 'all' }.\n\t\t\ttemplateLock: false,\n\t\t\t__experimentalLayout: LAYOUT,\n\t\t\tplaceholder: ! CustomPlaceholder ? placeholder : undefined,\n\t\t}\n\t);\n\n\t// Turn on contrast checker for web only since it's not supported on mobile yet.\n\tconst enableContrastChecking = Platform.OS === 'web';\n\n\tconst [ detectedBackgroundColor, setDetectedBackgroundColor ] = useState();\n\tconst [ detectedColor, setDetectedColor ] = useState();\n\tconst [\n\t\tdetectedOverlayBackgroundColor,\n\t\tsetDetectedOverlayBackgroundColor,\n\t] = useState();\n\tconst [ detectedOverlayColor, setDetectedOverlayColor ] = useState();\n\n\tuseEffect( () => {\n\t\tif ( ! enableContrastChecking ) {\n\t\t\treturn;\n\t\t}\n\t\tdetectColors(\n\t\t\tnavRef.current,\n\t\t\tsetDetectedColor,\n\t\t\tsetDetectedBackgroundColor\n\t\t);\n\t\tconst subMenuElement = navRef.current.querySelector(\n\t\t\t'[data-type=\"core/navigation-link\"] [data-type=\"core/navigation-link\"]'\n\t\t);\n\t\tif ( subMenuElement ) {\n\t\t\tdetectColors(\n\t\t\t\tsubMenuElement,\n\t\t\t\tsetDetectedOverlayColor,\n\t\t\t\tsetDetectedOverlayBackgroundColor\n\t\t\t);\n\t\t}\n\t} );\n\n\tif ( isPlaceholderShown ) {\n\t\tconst PlaceholderComponent = CustomPlaceholder\n\t\t\t? CustomPlaceholder\n\t\t\t: NavigationPlaceholder;\n\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<PlaceholderComponent\n\t\t\t\t\tonCreate={ ( blocks, selectNavigationBlock ) => {\n\t\t\t\t\t\tsetIsPlaceholderShown( false );\n\t\t\t\t\t\tupdateInnerBlocks( blocks );\n\t\t\t\t\t\tif ( selectNavigationBlock ) {\n\t\t\t\t\t\t\tselectBlock( clientId );\n\t\t\t\t\t\t}\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tconst justifyAllowedControls =\n\t\tattributes.orientation === 'vertical'\n\t\t\t? [ 'left', 'center', 'right' ]\n\t\t\t: [ 'left', 'center', 'right', 'space-between' ];\n\n\treturn (\n\t\t<>\n\t\t\t<BlockControls>\n\t\t\t\t{ hasItemJustificationControls && (\n\t\t\t\t\t<JustifyToolbar\n\t\t\t\t\t\tvalue={ attributes.itemsJustification }\n\t\t\t\t\t\tallowedControls={ justifyAllowedControls }\n\t\t\t\t\t\tonChange={ ( value ) =>\n\t\t\t\t\t\t\tsetAttributes( { itemsJustification: value } )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpopoverProps={ {\n\t\t\t\t\t\t\tposition: 'bottom right',\n\t\t\t\t\t\t\tisAlternate: true,\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t\t<ToolbarGroup>{ navigatorToolbarButton }</ToolbarGroup>\n\t\t\t</BlockControls>\n\t\t\t{ navigatorModal }\n\t\t\t<InspectorControls>\n\t\t\t\t{ hasSubmenuIndicatorSetting && (\n\t\t\t\t\t<PanelBody title={ __( 'Display settings' ) }>\n\t\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t\tchecked={ attributes.isResponsive }\n\t\t\t\t\t\t\tonChange={ ( value ) => {\n\t\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\t\tisResponsive: value,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\tlabel={ __( 'Enable responsive menu' ) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t\tchecked={ attributes.openSubmenusOnClick }\n\t\t\t\t\t\t\tonChange={ ( value ) => {\n\t\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\t\topenSubmenusOnClick: value,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\tlabel={ __( 'Open submenus on click' ) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{ ! attributes.openSubmenusOnClick && (\n\t\t\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t\t\tchecked={ attributes.showSubmenuIcon }\n\t\t\t\t\t\t\t\tonChange={ ( value ) => {\n\t\t\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\t\t\tshowSubmenuIcon: value,\n\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\tlabel={ __( 'Show submenu indicator icons' ) }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</PanelBody>\n\t\t\t\t) }\n\t\t\t\t{ hasColorSettings && (\n\t\t\t\t\t<PanelColorSettings\n\t\t\t\t\t\ttitle={ __( 'Color' ) }\n\t\t\t\t\t\tinitialOpen={ false }\n\t\t\t\t\t\tcolorSettings={ [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvalue: textColor.color,\n\t\t\t\t\t\t\t\tonChange: setTextColor,\n\t\t\t\t\t\t\t\tlabel: __( 'Text' ),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvalue: backgroundColor.color,\n\t\t\t\t\t\t\t\tonChange: setBackgroundColor,\n\t\t\t\t\t\t\t\tlabel: __( 'Background' ),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvalue: overlayTextColor.color,\n\t\t\t\t\t\t\t\tonChange: setOverlayTextColor,\n\t\t\t\t\t\t\t\tlabel: __( 'Overlay text' ),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvalue: overlayBackgroundColor.color,\n\t\t\t\t\t\t\t\tonChange: setOverlayBackgroundColor,\n\t\t\t\t\t\t\t\tlabel: __( 'Overlay background' ),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t] }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ enableContrastChecking && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<ContrastChecker\n\t\t\t\t\t\t\t\t\tbackgroundColor={ detectedBackgroundColor }\n\t\t\t\t\t\t\t\t\ttextColor={ detectedColor }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<ContrastChecker\n\t\t\t\t\t\t\t\t\tbackgroundColor={\n\t\t\t\t\t\t\t\t\t\tdetectedOverlayBackgroundColor\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ttextColor={ detectedOverlayColor }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</PanelColorSettings>\n\t\t\t\t) }\n\t\t\t</InspectorControls>\n\t\t\t<nav { ...blockProps }>\n\t\t\t\t<ResponsiveWrapper\n\t\t\t\t\tid={ clientId }\n\t\t\t\t\tonToggle={ setResponsiveMenuVisibility }\n\t\t\t\t\tisOpen={ isResponsiveMenuOpen }\n\t\t\t\t\tisResponsive={ attributes.isResponsive }\n\t\t\t\t>\n\t\t\t\t\t<div { ...innerBlocksProps }></div>\n\t\t\t\t</ResponsiveWrapper>\n\t\t\t</nav>\n\t\t</>\n\t);\n}\n\nexport default compose( [\n\twithSelect( ( select, { clientId } ) => {\n\t\tconst innerBlocks = select( blockEditorStore ).getBlocks( clientId );\n\t\tconst {\n\t\t\tgetClientIdsOfDescendants,\n\t\t\thasSelectedInnerBlock,\n\t\t\tgetSelectedBlockClientId,\n\t\t} = select( blockEditorStore );\n\t\tconst isImmediateParentOfSelectedBlock = hasSelectedInnerBlock(\n\t\t\tclientId,\n\t\t\tfalse\n\t\t);\n\t\tconst selectedBlockId = getSelectedBlockClientId();\n\t\tconst selectedBlockHasDescendants = !! getClientIdsOfDescendants( [\n\t\t\tselectedBlockId,\n\t\t] )?.length;\n\n\t\treturn {\n\t\t\tisImmediateParentOfSelectedBlock,\n\t\t\tselectedBlockHasDescendants,\n\t\t\thasExistingNavItems: !! innerBlocks.length,\n\n\t\t\t// This prop is already available but computing it here ensures it's\n\t\t\t// fresh compared to isImmediateParentOfSelectedBlock\n\t\t\tisSelected: selectedBlockId === clientId,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, { clientId } ) => {\n\t\treturn {\n\t\t\tupdateInnerBlocks( blocks ) {\n\t\t\t\tif ( blocks?.length === 0 ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tdispatch( blockEditorStore ).replaceInnerBlocks(\n\t\t\t\t\tclientId,\n\t\t\t\t\tblocks,\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t},\n\t\t};\n\t} ),\n\twithColors(\n\t\t{ textColor: 'color' },\n\t\t{ backgroundColor: 'color' },\n\t\t{ overlayBackgroundColor: 'color' },\n\t\t{ overlayTextColor: 'color' }\n\t),\n] )( Navigation );\n"]}