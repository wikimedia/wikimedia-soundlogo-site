{"version":3,"sources":["@wordpress/block-library/src/gallery/use-get-media.js"],"names":["useGetMedia","innerBlockImages","currentImageMedia","setCurrentImageMedia","imageMedia","select","length","imageIds","map","imageBlock","attributes","id","filter","undefined","getMedia","coreStore","newImageMedia","img","some","newImage","find","currentImage"],"mappings":";;;;;;;AAGA;;AACA;;AACA;;AALA;AACA;AACA;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,SAASA,WAAT,CAAsBC,gBAAtB,EAAyC;AACvD,QAAM,CAAEC,iBAAF,EAAqBC,oBAArB,IAA8C,uBAAU,EAAV,CAApD;AAEA,QAAMC,UAAU,GAAG,qBAChBC,MAAF,IAAc;AACb,QAAK,EAAEJ,gBAAF,aAAEA,gBAAF,eAAEA,gBAAgB,CAAEK,MAApB,CAAL,EAAkC;AACjC,aAAOJ,iBAAP;AACA;;AAED,UAAMK,QAAQ,GAAGN,gBAAgB,CAC/BO,GADe,CACRC,UAAF,IAAkBA,UAAU,CAACC,UAAX,CAAsBC,EAD9B,EAEfC,MAFe,CAELD,EAAF,IAAUA,EAAE,KAAKE,SAFV,CAAjB;;AAIA,QAAKN,QAAQ,CAACD,MAAT,KAAoB,CAAzB,EAA6B;AAC5B,aAAOJ,iBAAP;AACA;;AACD,UAAMY,QAAQ,GAAGT,MAAM,CAAEU,eAAF,CAAN,CAAoBD,QAArC;AACA,UAAME,aAAa,GAAGT,QAAQ,CAACC,GAAT,CAAgBS,GAAF,IAAW;AAC9C,aAAOH,QAAQ,CAAEG,GAAF,CAAf;AACA,KAFqB,CAAtB;;AAIA,QAAKD,aAAa,CAACE,IAAd,CAAsBD,GAAF,IAAW,CAAEA,GAAjC,CAAL,EAA8C;AAC7C,aAAOf,iBAAP;AACA;;AAED,WAAOc,aAAP;AACA,GAvBiB,EAwBlB,CAAEf,gBAAF,CAxBkB,CAAnB;;AA2BA,MACC,CAAAG,UAAU,SAAV,IAAAA,UAAU,WAAV,YAAAA,UAAU,CAAEE,MAAZ,MAAuBJ,iBAAiB,CAACI,MAAzC,IACAF,UAAU,CAACc,IAAX,CACGC,QAAF,IACC,CAAEjB,iBAAiB,CAACkB,IAAlB,CACCC,YAAF,IAAoBA,YAAY,CAACV,EAAb,KAAoBQ,QAAQ,CAACR,EADhD,CAFJ,CAFD,EAQE;AACDR,IAAAA,oBAAoB,CAAEC,UAAF,CAApB;AACA,WAAOA,UAAP;AACA;;AACD,SAAOF,iBAAP;AACA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useState } from '@wordpress/element';\nimport { useSelect } from '@wordpress/data';\nimport { store as coreStore } from '@wordpress/core-data';\n\n/**\n * Retrieves the extended media info for each gallery image from the store. This is used to\n * determine which image size options are available for the current gallery.\n *\n * @param {Array} innerBlockImages An array of the innerBlock images currently in the gallery.\n *\n * @return {Array} An array of media info options for each gallery image.\n */\nexport default function useGetMedia( innerBlockImages ) {\n\tconst [ currentImageMedia, setCurrentImageMedia ] = useState( [] );\n\n\tconst imageMedia = useSelect(\n\t\t( select ) => {\n\t\t\tif ( ! innerBlockImages?.length ) {\n\t\t\t\treturn currentImageMedia;\n\t\t\t}\n\n\t\t\tconst imageIds = innerBlockImages\n\t\t\t\t.map( ( imageBlock ) => imageBlock.attributes.id )\n\t\t\t\t.filter( ( id ) => id !== undefined );\n\n\t\t\tif ( imageIds.length === 0 ) {\n\t\t\t\treturn currentImageMedia;\n\t\t\t}\n\t\t\tconst getMedia = select( coreStore ).getMedia;\n\t\t\tconst newImageMedia = imageIds.map( ( img ) => {\n\t\t\t\treturn getMedia( img );\n\t\t\t} );\n\n\t\t\tif ( newImageMedia.some( ( img ) => ! img ) ) {\n\t\t\t\treturn currentImageMedia;\n\t\t\t}\n\n\t\t\treturn newImageMedia;\n\t\t},\n\t\t[ innerBlockImages ]\n\t);\n\n\tif (\n\t\timageMedia?.length !== currentImageMedia.length ||\n\t\timageMedia.some(\n\t\t\t( newImage ) =>\n\t\t\t\t! currentImageMedia.find(\n\t\t\t\t\t( currentImage ) => currentImage.id === newImage.id\n\t\t\t\t)\n\t\t)\n\t) {\n\t\tsetCurrentImageMedia( imageMedia );\n\t\treturn imageMedia;\n\t}\n\treturn currentImageMedia;\n}\n"]}