{"version":3,"sources":["@wordpress/editor/src/components/post-visibility/index.js"],"names":["__","Component","VisuallyHidden","withInstanceId","compose","withSelect","withDispatch","visibilityOptions","store","editorStore","PostVisibility","constructor","props","arguments","setPublic","bind","setPrivate","setPasswordProtected","updatePassword","state","hasPassword","password","visibility","onUpdateVisibility","status","setState","window","confirm","onSave","event","target","value","render","instanceId","visibilityHandlers","public","onSelect","checked","private","map","label","info","select","getEditedPostAttribute","getEditedPostVisibility","dispatch","savePost","editPost"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Component } from '@wordpress/element';\nimport { VisuallyHidden } from '@wordpress/components';\nimport { withInstanceId, compose } from '@wordpress/compose';\nimport { withSelect, withDispatch } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport { visibilityOptions } from './utils';\nimport { store as editorStore } from '../../store';\n\nexport class PostVisibility extends Component {\n\tconstructor( props ) {\n\t\tsuper( ...arguments );\n\n\t\tthis.setPublic = this.setPublic.bind( this );\n\t\tthis.setPrivate = this.setPrivate.bind( this );\n\t\tthis.setPasswordProtected = this.setPasswordProtected.bind( this );\n\t\tthis.updatePassword = this.updatePassword.bind( this );\n\n\t\tthis.state = {\n\t\t\thasPassword: !! props.password,\n\t\t};\n\t}\n\n\tsetPublic() {\n\t\tconst { visibility, onUpdateVisibility, status } = this.props;\n\n\t\tonUpdateVisibility( visibility === 'private' ? 'draft' : status );\n\t\tthis.setState( { hasPassword: false } );\n\t}\n\n\tsetPrivate() {\n\t\tif (\n\t\t\t// eslint-disable-next-line no-alert\n\t\t\t! window.confirm(\n\t\t\t\t__( 'Would you like to privately publish this post now?' )\n\t\t\t)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { onUpdateVisibility, onSave } = this.props;\n\n\t\tonUpdateVisibility( 'private' );\n\t\tthis.setState( { hasPassword: false } );\n\t\tonSave();\n\t}\n\n\tsetPasswordProtected() {\n\t\tconst { visibility, onUpdateVisibility, status, password } = this.props;\n\n\t\tonUpdateVisibility(\n\t\t\tvisibility === 'private' ? 'draft' : status,\n\t\t\tpassword || ''\n\t\t);\n\t\tthis.setState( { hasPassword: true } );\n\t}\n\n\tupdatePassword( event ) {\n\t\tconst { status, onUpdateVisibility } = this.props;\n\t\tonUpdateVisibility( status, event.target.value );\n\t}\n\n\trender() {\n\t\tconst { visibility, password, instanceId } = this.props;\n\n\t\tconst visibilityHandlers = {\n\t\t\tpublic: {\n\t\t\t\tonSelect: this.setPublic,\n\t\t\t\tchecked: visibility === 'public' && ! this.state.hasPassword,\n\t\t\t},\n\t\t\tprivate: {\n\t\t\t\tonSelect: this.setPrivate,\n\t\t\t\tchecked: visibility === 'private',\n\t\t\t},\n\t\t\tpassword: {\n\t\t\t\tonSelect: this.setPasswordProtected,\n\t\t\t\tchecked: this.state.hasPassword,\n\t\t\t},\n\t\t};\n\n\t\treturn [\n\t\t\t<fieldset\n\t\t\t\tkey=\"visibility-selector\"\n\t\t\t\tclassName=\"editor-post-visibility__dialog-fieldset\"\n\t\t\t>\n\t\t\t\t<legend className=\"editor-post-visibility__dialog-legend\">\n\t\t\t\t\t{ __( 'Post Visibility' ) }\n\t\t\t\t</legend>\n\t\t\t\t{ visibilityOptions.map( ( { value, label, info } ) => (\n\t\t\t\t\t<div\n\t\t\t\t\t\tkey={ value }\n\t\t\t\t\t\tclassName=\"editor-post-visibility__choice\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\tname={ `editor-post-visibility__setting-${ instanceId }` }\n\t\t\t\t\t\t\tvalue={ value }\n\t\t\t\t\t\t\tonChange={ visibilityHandlers[ value ].onSelect }\n\t\t\t\t\t\t\tchecked={ visibilityHandlers[ value ].checked }\n\t\t\t\t\t\t\tid={ `editor-post-${ value }-${ instanceId }` }\n\t\t\t\t\t\t\taria-describedby={ `editor-post-${ value }-${ instanceId }-description` }\n\t\t\t\t\t\t\tclassName=\"editor-post-visibility__dialog-radio\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<label\n\t\t\t\t\t\t\thtmlFor={ `editor-post-${ value }-${ instanceId }` }\n\t\t\t\t\t\t\tclassName=\"editor-post-visibility__dialog-label\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ label }\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t<p\n\t\t\t\t\t\t\t\tid={ `editor-post-${ value }-${ instanceId }-description` }\n\t\t\t\t\t\t\t\tclassName=\"editor-post-visibility__dialog-info\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ info }\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t) ) }\n\t\t\t</fieldset>,\n\t\t\tthis.state.hasPassword && (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"editor-post-visibility__dialog-password\"\n\t\t\t\t\tkey=\"password-selector\"\n\t\t\t\t>\n\t\t\t\t\t<VisuallyHidden\n\t\t\t\t\t\tas=\"label\"\n\t\t\t\t\t\thtmlFor={ `editor-post-visibility__dialog-password-input-${ instanceId }` }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Create password' ) }\n\t\t\t\t\t</VisuallyHidden>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"editor-post-visibility__dialog-password-input\"\n\t\t\t\t\t\tid={ `editor-post-visibility__dialog-password-input-${ instanceId }` }\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tonChange={ this.updatePassword }\n\t\t\t\t\t\tvalue={ password }\n\t\t\t\t\t\tplaceholder={ __( 'Use a secure password' ) }\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t),\n\t\t];\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { getEditedPostAttribute, getEditedPostVisibility } = select(\n\t\t\teditorStore\n\t\t);\n\t\treturn {\n\t\t\tstatus: getEditedPostAttribute( 'status' ),\n\t\t\tvisibility: getEditedPostVisibility(),\n\t\t\tpassword: getEditedPostAttribute( 'password' ),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { savePost, editPost } = dispatch( editorStore );\n\t\treturn {\n\t\t\tonSave: savePost,\n\t\t\tonUpdateVisibility( status, password = '' ) {\n\t\t\t\teditPost( { status, password } );\n\t\t\t},\n\t\t};\n\t} ),\n\twithInstanceId,\n] )( PostVisibility );\n"]}