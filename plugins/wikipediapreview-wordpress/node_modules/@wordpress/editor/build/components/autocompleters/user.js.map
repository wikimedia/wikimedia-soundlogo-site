{"version":3,"sources":["@wordpress/editor/src/components/autocompleters/user.js"],"names":["getUserLabel","user","avatar","avatar_urls","name","slug","className","triggerPrefix","useItems","filterValue","users","select","getUsers","coreStore","context","search","encodeURIComponent","options","map","key","value","label","getOptionCompletion"],"mappings":";;;;;;;;AAGA;;AACA;;AACA;;AALA;AACA;AACA;;AAKA;AAEO,SAASA,YAAT,CAAuBC,IAAvB,EAA8B;AACpC,QAAMC,MAAM,GACXD,IAAI,CAACE,WAAL,IAAoBF,IAAI,CAACE,WAAL,CAAkB,EAAlB,CAApB,GACC;AACC,IAAA,SAAS,EAAC,oCADX;AAEC,IAAA,GAAG,EAAC,EAFL;AAGC,IAAA,GAAG,EAAGF,IAAI,CAACE,WAAL,CAAkB,EAAlB;AAHP,IADD,GAOC;AAAM,IAAA,SAAS,EAAC;AAAhB,IARF;AAWA,SACC,qDACGD,MADH,EAEC;AAAM,IAAA,SAAS,EAAC;AAAhB,KACGD,IAAI,CAACG,IADR,CAFD,EAKC;AAAM,IAAA,SAAS,EAAC;AAAhB,KACGH,IAAI,CAACI,IADR,CALD,CADD;AAWA;AAED;AACA;AACA;AACA;AACA;;;eACe;AACdD,EAAAA,IAAI,EAAE,OADQ;AAEdE,EAAAA,SAAS,EAAE,6BAFG;AAGdC,EAAAA,aAAa,EAAE,GAHD;;AAKdC,EAAAA,QAAQ,CAAEC,WAAF,EAAgB;AACvB,UAAMC,KAAK,GAAG,qBACXC,MAAF,IAAc;AACb,YAAM;AAAEC,QAAAA;AAAF,UAAeD,MAAM,CAAEE,eAAF,CAA3B;AACA,aAAOD,QAAQ,CAAE;AAChBE,QAAAA,OAAO,EAAE,MADO;AAEhBC,QAAAA,MAAM,EAAEC,kBAAkB,CAAEP,WAAF;AAFV,OAAF,CAAf;AAIA,KAPY,EAQb,CAAEA,WAAF,CARa,CAAd;AAWA,UAAMQ,OAAO,GAAG,sBACf,MACCP,KAAK,GACFA,KAAK,CAACQ,GAAN,CAAajB,IAAF,KAAc;AACzBkB,MAAAA,GAAG,EAAG,QAAQlB,IAAI,CAACI,IAAM,EADA;AAEzBe,MAAAA,KAAK,EAAEnB,IAFkB;AAGzBoB,MAAAA,KAAK,EAAErB,YAAY,CAAEC,IAAF;AAHM,KAAd,CAAX,CADE,GAMF,EARW,EASf,CAAES,KAAF,CATe,CAAhB;AAYA,WAAO,CAAEO,OAAF,CAAP;AACA,GA9Ba;;AAgCdK,EAAAA,mBAAmB,CAAErB,IAAF,EAAS;AAC3B,WAAQ,IAAIA,IAAI,CAACI,IAAM,EAAvB;AACA;;AAlCa,C","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useMemo } from '@wordpress/element';\nimport { useSelect } from '@wordpress/data';\nimport { store as coreStore } from '@wordpress/core-data';\n\n/** @typedef {import('@wordpress/components').WPCompleter} WPCompleter */\n\nexport function getUserLabel( user ) {\n\tconst avatar =\n\t\tuser.avatar_urls && user.avatar_urls[ 24 ] ? (\n\t\t\t<img\n\t\t\t\tclassName=\"editor-autocompleters__user-avatar\"\n\t\t\t\talt=\"\"\n\t\t\t\tsrc={ user.avatar_urls[ 24 ] }\n\t\t\t/>\n\t\t) : (\n\t\t\t<span className=\"editor-autocompleters__no-avatar\"></span>\n\t\t);\n\n\treturn (\n\t\t<>\n\t\t\t{ avatar }\n\t\t\t<span className=\"editor-autocompleters__user-name\">\n\t\t\t\t{ user.name }\n\t\t\t</span>\n\t\t\t<span className=\"editor-autocompleters__user-slug\">\n\t\t\t\t{ user.slug }\n\t\t\t</span>\n\t\t</>\n\t);\n}\n\n/**\n * A user mentions completer.\n *\n * @type {WPCompleter}\n */\nexport default {\n\tname: 'users',\n\tclassName: 'editor-autocompleters__user',\n\ttriggerPrefix: '@',\n\n\tuseItems( filterValue ) {\n\t\tconst users = useSelect(\n\t\t\t( select ) => {\n\t\t\t\tconst { getUsers } = select( coreStore );\n\t\t\t\treturn getUsers( {\n\t\t\t\t\tcontext: 'view',\n\t\t\t\t\tsearch: encodeURIComponent( filterValue ),\n\t\t\t\t} );\n\t\t\t},\n\t\t\t[ filterValue ]\n\t\t);\n\n\t\tconst options = useMemo(\n\t\t\t() =>\n\t\t\t\tusers\n\t\t\t\t\t? users.map( ( user ) => ( {\n\t\t\t\t\t\t\tkey: `user-${ user.slug }`,\n\t\t\t\t\t\t\tvalue: user,\n\t\t\t\t\t\t\tlabel: getUserLabel( user ),\n\t\t\t\t\t  } ) )\n\t\t\t\t\t: [],\n\t\t\t[ users ]\n\t\t);\n\n\t\treturn [ options ];\n\t},\n\n\tgetOptionCompletion( user ) {\n\t\treturn `@${ user.slug }`;\n\t},\n};\n"]}