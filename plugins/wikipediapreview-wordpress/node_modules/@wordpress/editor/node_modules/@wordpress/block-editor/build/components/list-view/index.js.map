{"version":3,"sources":["@wordpress/block-editor/src/components/list-view/index.js"],"names":["noop","expanded","state","action","type","clientId","ListView","blocks","showOnlyCurrentHierarchy","onSelect","__experimentalFeatures","__experimentalPersistentListViewFeatures","props","ref","clientIdsTree","selectedClientIds","draggedClientIds","selectBlock","blockEditorStore","selectEditorBlock","expandedState","setExpandedState","dropZoneRef","target","blockDropTarget","elementRef","treeGridRef","isMounted","current","expand","collapse","expandRow","row","dataset","block","collapseRow","contextValue","isTreeGridMounted"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\n\nimport { useMergeRefs } from '@wordpress/compose';\nimport { __experimentalTreeGrid as TreeGrid } from '@wordpress/components';\nimport { AsyncModeProvider, useDispatch } from '@wordpress/data';\nimport {\n\tuseCallback,\n\tuseEffect,\n\tuseMemo,\n\tuseRef,\n\tuseReducer,\n\tforwardRef,\n} from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport ListViewBranch from './branch';\nimport { ListViewContext } from './context';\nimport ListViewDropIndicator from './drop-indicator';\nimport useListViewClientIds from './use-list-view-client-ids';\nimport useListViewDropZone from './use-list-view-drop-zone';\nimport { store as blockEditorStore } from '../../store';\n\nconst noop = () => {};\nconst expanded = ( state, action ) => {\n\tswitch ( action.type ) {\n\t\tcase 'expand':\n\t\t\treturn { ...state, ...{ [ action.clientId ]: true } };\n\t\tcase 'collapse':\n\t\t\treturn { ...state, ...{ [ action.clientId ]: false } };\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n\n/**\n * Wrap `ListViewRows` with `TreeGrid`. ListViewRows is a\n * recursive component (it renders itself), so this ensures TreeGrid is only\n * present at the very top of the navigation grid.\n *\n * @param {Object}   props                                          Components props.\n * @param {Array}    props.blocks                                   Custom subset of block client IDs to be used instead of the default hierarchy.\n * @param {Function} props.onSelect                                 Block selection callback.\n * @param {boolean}  props.showNestedBlocks                         Flag to enable displaying nested blocks.\n * @param {boolean}  props.showOnlyCurrentHierarchy                 Flag to limit the list to the current hierarchy of blocks.\n * @param {boolean}  props.__experimentalFeatures                   Flag to enable experimental features.\n * @param {boolean}  props.__experimentalPersistentListViewFeatures Flag to enable features for the Persistent List View experiment.\n * @param {Object}   ref                                            Forwarded ref\n */\nfunction ListView(\n\t{\n\t\tblocks,\n\t\tshowOnlyCurrentHierarchy,\n\t\tonSelect = noop,\n\t\t__experimentalFeatures,\n\t\t__experimentalPersistentListViewFeatures,\n\t\t...props\n\t},\n\tref\n) {\n\tconst {\n\t\tclientIdsTree,\n\t\tselectedClientIds,\n\t\tdraggedClientIds,\n\t} = useListViewClientIds(\n\t\tblocks,\n\t\tshowOnlyCurrentHierarchy,\n\t\t__experimentalPersistentListViewFeatures\n\t);\n\tconst { selectBlock } = useDispatch( blockEditorStore );\n\tconst selectEditorBlock = useCallback(\n\t\t( clientId ) => {\n\t\t\tselectBlock( clientId );\n\t\t\tonSelect( clientId );\n\t\t},\n\t\t[ selectBlock, onSelect ]\n\t);\n\tconst [ expandedState, setExpandedState ] = useReducer( expanded, {} );\n\n\tconst { ref: dropZoneRef, target: blockDropTarget } = useListViewDropZone();\n\tconst elementRef = useRef();\n\tconst treeGridRef = useMergeRefs( [ elementRef, dropZoneRef, ref ] );\n\n\tconst isMounted = useRef( false );\n\tuseEffect( () => {\n\t\tisMounted.current = true;\n\t}, [] );\n\n\tconst expand = useCallback(\n\t\t( clientId ) => {\n\t\t\tif ( ! clientId ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsetExpandedState( { type: 'expand', clientId } );\n\t\t},\n\t\t[ setExpandedState ]\n\t);\n\tconst collapse = useCallback(\n\t\t( clientId ) => {\n\t\t\tif ( ! clientId ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsetExpandedState( { type: 'collapse', clientId } );\n\t\t},\n\t\t[ setExpandedState ]\n\t);\n\tconst expandRow = ( row ) => {\n\t\texpand( row?.dataset?.block );\n\t};\n\tconst collapseRow = ( row ) => {\n\t\tcollapse( row?.dataset?.block );\n\t};\n\n\tconst contextValue = useMemo(\n\t\t() => ( {\n\t\t\t__experimentalFeatures,\n\t\t\t__experimentalPersistentListViewFeatures,\n\t\t\tisTreeGridMounted: isMounted.current,\n\t\t\tdraggedClientIds,\n\t\t\tselectedClientIds,\n\t\t\texpandedState,\n\t\t\texpand,\n\t\t\tcollapse,\n\t\t} ),\n\t\t[\n\t\t\t__experimentalFeatures,\n\t\t\t__experimentalPersistentListViewFeatures,\n\t\t\tisMounted.current,\n\t\t\tdraggedClientIds,\n\t\t\tselectedClientIds,\n\t\t\texpandedState,\n\t\t\texpand,\n\t\t\tcollapse,\n\t\t]\n\t);\n\n\treturn (\n\t\t<AsyncModeProvider value={ true }>\n\t\t\t<ListViewDropIndicator\n\t\t\t\tlistViewRef={ elementRef }\n\t\t\t\tblockDropTarget={ blockDropTarget }\n\t\t\t/>\n\t\t\t<TreeGrid\n\t\t\t\tclassName=\"block-editor-list-view-tree\"\n\t\t\t\taria-label={ __( 'Block navigation structure' ) }\n\t\t\t\tref={ treeGridRef }\n\t\t\t\tonCollapseRow={ collapseRow }\n\t\t\t\tonExpandRow={ expandRow }\n\t\t\t>\n\t\t\t\t<ListViewContext.Provider value={ contextValue }>\n\t\t\t\t\t<ListViewBranch\n\t\t\t\t\t\tblocks={ clientIdsTree }\n\t\t\t\t\t\tselectBlock={ selectEditorBlock }\n\t\t\t\t\t\t{ ...props }\n\t\t\t\t\t/>\n\t\t\t\t</ListViewContext.Provider>\n\t\t\t</TreeGrid>\n\t\t</AsyncModeProvider>\n\t);\n}\nexport default forwardRef( ListView );\n"]}