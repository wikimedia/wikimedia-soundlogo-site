{"version":3,"sources":["@wordpress/block-editor/src/components/list-view/use-list-view-client-ids.js"],"names":["useListViewClientIdsTree","blocks","selectedClientIds","showOnlyCurrentHierarchy","select","getBlockHierarchyRootClientId","__unstableGetClientIdsTree","__unstableGetClientIdWithClientIdsTree","blockEditorStore","isSingleBlockSelected","Array","isArray","rootBlock","hasHierarchy","clientId","innerBlocks","length","useListViewClientIds","__experimentalPersistentListViewFeatures","draggedClientIds","getSelectedBlockClientId","getSelectedBlockClientIds","getDraggedBlockClientIds","clientIdsTree"],"mappings":";;;;;;;AAIA;;AAKA;;AACA;;AAVA;AACA;AACA;;AAIA;AACA;AACA;AAIA,MAAMA,wBAAwB,GAAG,CAChCC,MADgC,EAEhCC,iBAFgC,EAGhCC,wBAHgC,KAKhC,qBACGC,MAAF,IAAc;AACb,QAAM;AACLC,IAAAA,6BADK;AAELC,IAAAA,0BAFK;AAGLC,IAAAA;AAHK,MAIFH,MAAM,CAAEI,YAAF,CAJV;;AAMA,MAAKP,MAAL,EAAc;AACb,WAAOA,MAAP;AACA;;AAED,QAAMQ,qBAAqB,GAC1BP,iBAAiB,IAAI,CAAEQ,KAAK,CAACC,OAAN,CAAeT,iBAAf,CADxB;;AAEA,MAAK,CAAEC,wBAAF,IAA8B,CAAEM,qBAArC,EAA6D;AAC5D,WAAOH,0BAA0B,EAAjC;AACA;;AAED,QAAMM,SAAS,GAAGL,sCAAsC,CACvDF,6BAA6B,CAAEH,iBAAF,CAD0B,CAAxD;;AAGA,MAAK,CAAEU,SAAP,EAAmB;AAClB,WAAON,0BAA0B,EAAjC;AACA;;AAED,QAAMO,YAAY,GACjB,CAAE,+BAAoBD,SAAS,CAACE,QAA9B,EAAwCZ,iBAAxC,CAAF,IACEU,SAAS,CAACG,WAAV,IAAyBH,SAAS,CAACG,WAAV,CAAsBC,MAAtB,KAAiC,CAF7D;;AAGA,MAAKH,YAAL,EAAoB;AACnB,WAAO,CAAED,SAAF,CAAP;AACA;;AAED,SAAON,0BAA0B,EAAjC;AACA,CAjCF,EAkCC,CAAEL,MAAF,EAAUC,iBAAV,EAA6BC,wBAA7B,CAlCD,CALD;;AA0Ce,SAASc,oBAAT,CACdhB,MADc,EAEdE,wBAFc,EAGde,wCAHc,EAIb;AACD,QAAM;AAAEhB,IAAAA,iBAAF;AAAqBiB,IAAAA;AAArB,MAA0C,qBAC7Cf,MAAF,IAAc;AACb,UAAM;AACLgB,MAAAA,wBADK;AAELC,MAAAA,yBAFK;AAGLC,MAAAA;AAHK,QAIFlB,MAAM,CAAEI,YAAF,CAJV;;AAMA,QAAKU,wCAAL,EAAgD;AAC/C,aAAO;AACNhB,QAAAA,iBAAiB,EAAEmB,yBAAyB,EADtC;AAENF,QAAAA,gBAAgB,EAAEG,wBAAwB;AAFpC,OAAP;AAIA;;AAED,WAAO;AACNpB,MAAAA,iBAAiB,EAAEkB,wBAAwB,EADrC;AAEND,MAAAA,gBAAgB,EAAEG,wBAAwB;AAFpC,KAAP;AAIA,GAnB8C,EAoB/C,CAAEJ,wCAAF,CApB+C,CAAhD;AAsBA,QAAMK,aAAa,GAAGvB,wBAAwB,CAC7CC,MAD6C,EAE7CC,iBAF6C,EAG7CC,wBAH6C,CAA9C;AAKA,SAAO;AAAEoB,IAAAA,aAAF;AAAiBrB,IAAAA,iBAAjB;AAAoCiB,IAAAA;AAApC,GAAP;AACA","sourcesContent":["/**\n * WordPress dependencies\n */\n\nimport { useSelect } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport { isClientIdSelected } from './utils';\nimport { store as blockEditorStore } from '../../store';\n\nconst useListViewClientIdsTree = (\n\tblocks,\n\tselectedClientIds,\n\tshowOnlyCurrentHierarchy\n) =>\n\tuseSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetBlockHierarchyRootClientId,\n\t\t\t\t__unstableGetClientIdsTree,\n\t\t\t\t__unstableGetClientIdWithClientIdsTree,\n\t\t\t} = select( blockEditorStore );\n\n\t\t\tif ( blocks ) {\n\t\t\t\treturn blocks;\n\t\t\t}\n\n\t\t\tconst isSingleBlockSelected =\n\t\t\t\tselectedClientIds && ! Array.isArray( selectedClientIds );\n\t\t\tif ( ! showOnlyCurrentHierarchy || ! isSingleBlockSelected ) {\n\t\t\t\treturn __unstableGetClientIdsTree();\n\t\t\t}\n\n\t\t\tconst rootBlock = __unstableGetClientIdWithClientIdsTree(\n\t\t\t\tgetBlockHierarchyRootClientId( selectedClientIds )\n\t\t\t);\n\t\t\tif ( ! rootBlock ) {\n\t\t\t\treturn __unstableGetClientIdsTree();\n\t\t\t}\n\n\t\t\tconst hasHierarchy =\n\t\t\t\t! isClientIdSelected( rootBlock.clientId, selectedClientIds ) ||\n\t\t\t\t( rootBlock.innerBlocks && rootBlock.innerBlocks.length !== 0 );\n\t\t\tif ( hasHierarchy ) {\n\t\t\t\treturn [ rootBlock ];\n\t\t\t}\n\n\t\t\treturn __unstableGetClientIdsTree();\n\t\t},\n\t\t[ blocks, selectedClientIds, showOnlyCurrentHierarchy ]\n\t);\n\nexport default function useListViewClientIds(\n\tblocks,\n\tshowOnlyCurrentHierarchy,\n\t__experimentalPersistentListViewFeatures\n) {\n\tconst { selectedClientIds, draggedClientIds } = useSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetSelectedBlockClientId,\n\t\t\t\tgetSelectedBlockClientIds,\n\t\t\t\tgetDraggedBlockClientIds,\n\t\t\t} = select( blockEditorStore );\n\n\t\t\tif ( __experimentalPersistentListViewFeatures ) {\n\t\t\t\treturn {\n\t\t\t\t\tselectedClientIds: getSelectedBlockClientIds(),\n\t\t\t\t\tdraggedClientIds: getDraggedBlockClientIds(),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tselectedClientIds: getSelectedBlockClientId(),\n\t\t\t\tdraggedClientIds: getDraggedBlockClientIds(),\n\t\t\t};\n\t\t},\n\t\t[ __experimentalPersistentListViewFeatures ]\n\t);\n\tconst clientIdsTree = useListViewClientIdsTree(\n\t\tblocks,\n\t\tselectedClientIds,\n\t\tshowOnlyCurrentHierarchy\n\t);\n\treturn { clientIdsTree, selectedClientIds, draggedClientIds };\n}\n"]}