{"version":3,"sources":["@wordpress/components/src/unit-control/utils.ts"],"names":["__","_x","Platform","isWeb","OS","allUnits","px","value","label","default","a11yLabel","step","em","rem","vw","vh","vmin","vmax","ch","ex","cm","mm","in","pc","pt","ALL_CSS_UNITS","Object","values","CSS_UNITS","DEFAULT_UNIT","getParsedValue","unit","units","initialValue","parseUnit","hasUnits","Array","isArray","length","String","trim","num","parseFloat","isNaN","unitMatch","match","undefined","toLowerCase","find","item","getValidParsedUnit","next","fallbackValue","fallbackUnit","parsedValue","parsedUnit","baseValue","baseUnit","Number","isFinite","parseA11yLabelForUnit","filterUnitsWithSettings","unitSetting","filter","includes","useCustomUnits","availableUnits","defaultValues","usedUnits","forEach","i","getUnitsWithCurrentUnit","currentValue","legacyUnit","unitsWithCurrentUnit","currentUnit","some","unshift"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __, _x } from '@wordpress/i18n';\nimport { Platform } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport type { Value, WPUnitControlUnit, WPUnitControlUnitList } from './types';\n\nconst isWeb = Platform.OS === 'web';\n\nconst allUnits: Record< string, WPUnitControlUnit > = {\n\tpx: {\n\t\tvalue: 'px',\n\t\tlabel: isWeb ? 'px' : __( 'Pixels (px)' ),\n\t\tdefault: '',\n\t\ta11yLabel: __( 'Pixels (px)' ),\n\t\tstep: 1,\n\t},\n\t'%': {\n\t\tvalue: '%',\n\t\tlabel: isWeb ? '%' : __( 'Percentage (%)' ),\n\t\tdefault: '',\n\t\ta11yLabel: __( 'Percent (%)' ),\n\t\tstep: 0.1,\n\t},\n\tem: {\n\t\tvalue: 'em',\n\t\tlabel: isWeb ? 'em' : __( 'Relative to parent font size (em)' ),\n\t\tdefault: '',\n\t\ta11yLabel: _x( 'ems', 'Relative to parent font size (em)' ),\n\t\tstep: 0.01,\n\t},\n\trem: {\n\t\tvalue: 'rem',\n\t\tlabel: isWeb ? 'rem' : __( 'Relative to root font size (rem)' ),\n\t\tdefault: '',\n\t\ta11yLabel: _x( 'rems', 'Relative to root font size (rem)' ),\n\t\tstep: 0.01,\n\t},\n\tvw: {\n\t\tvalue: 'vw',\n\t\tlabel: isWeb ? 'vw' : __( 'Viewport width (vw)' ),\n\t\tdefault: '',\n\t\ta11yLabel: __( 'Viewport width (vw)' ),\n\t\tstep: 0.1,\n\t},\n\tvh: {\n\t\tvalue: 'vh',\n\t\tlabel: isWeb ? 'vh' : __( 'Viewport height (vh)' ),\n\t\tdefault: '',\n\t\ta11yLabel: __( 'Viewport height (vh)' ),\n\t\tstep: 0.1,\n\t},\n\tvmin: {\n\t\tvalue: 'vmin',\n\t\tlabel: isWeb ? 'vmin' : __( 'Viewport smallest dimension (vmin)' ),\n\t\tdefault: '',\n\t\ta11yLabel: __( 'Viewport smallest dimension (vmin)' ),\n\t\tstep: 0.1,\n\t},\n\tvmax: {\n\t\tvalue: 'vmax',\n\t\tlabel: isWeb ? 'vmax' : __( 'Viewport largest dimension (vmax)' ),\n\t\tdefault: '',\n\t\ta11yLabel: __( 'Viewport largest dimension (vmax)' ),\n\t\tstep: 0.1,\n\t},\n\tch: {\n\t\tvalue: 'ch',\n\t\tlabel: isWeb ? 'ch' : __( 'Width of the zero (0) character (ch)' ),\n\t\tdefault: '',\n\t\ta11yLabel: __( 'Width of the zero (0) character (ch)' ),\n\t\tstep: 0.01,\n\t},\n\tex: {\n\t\tvalue: 'ex',\n\t\tlabel: isWeb ? 'ex' : __( 'x-height of the font (ex)' ),\n\t\tdefault: '',\n\t\ta11yLabel: __( 'x-height of the font (ex)' ),\n\t\tstep: 0.01,\n\t},\n\tcm: {\n\t\tvalue: 'cm',\n\t\tlabel: isWeb ? 'cm' : __( 'Centimeters (cm)' ),\n\t\tdefault: '',\n\t\ta11yLabel: __( 'Centimeters (cm)' ),\n\t\tstep: 0.001,\n\t},\n\tmm: {\n\t\tvalue: 'mm',\n\t\tlabel: isWeb ? 'mm' : __( 'Millimeters (mm)' ),\n\t\tdefault: '',\n\t\ta11yLabel: __( 'Millimeters (mm)' ),\n\t\tstep: 0.1,\n\t},\n\tin: {\n\t\tvalue: 'in',\n\t\tlabel: isWeb ? 'in' : __( 'Inches (in)' ),\n\t\tdefault: '',\n\t\ta11yLabel: __( 'Inches (in)' ),\n\t\tstep: 0.001,\n\t},\n\tpc: {\n\t\tvalue: 'pc',\n\t\tlabel: isWeb ? 'pc' : __( 'Picas (pc)' ),\n\t\tdefault: '',\n\t\ta11yLabel: __( 'Picas (pc)' ),\n\t\tstep: 1,\n\t},\n\tpt: {\n\t\tvalue: 'pt',\n\t\tlabel: isWeb ? 'pt' : __( 'Points (pt)' ),\n\t\tdefault: '',\n\t\ta11yLabel: __( 'Points (pt)' ),\n\t\tstep: 1,\n\t},\n};\n\n/**\n * An array of all available CSS length units.\n */\nexport const ALL_CSS_UNITS = Object.values( allUnits );\n\n/**\n * Units of measurements. `a11yLabel` is used by screenreaders.\n */\nexport const CSS_UNITS = [\n\tallUnits.px,\n\tallUnits[ '%' ],\n\tallUnits.em,\n\tallUnits.rem,\n\tallUnits.vw,\n\tallUnits.vh,\n];\n\nexport const DEFAULT_UNIT = allUnits.px;\n\n/**\n * Handles legacy value + unit handling.\n * This component use to manage both incoming value and units separately.\n *\n * Moving forward, ideally the value should be a string that contains both\n * the value and unit, example: '10px'\n *\n * @param  value Value\n * @param  unit  Unit value\n * @param  units Units to derive from.\n * @return The extracted number and unit.\n */\nexport function getParsedValue(\n\tvalue: Value,\n\tunit?: string,\n\tunits?: WPUnitControlUnitList\n): [ Value, string ] {\n\tconst initialValue = unit ? `${ value }${ unit }` : value;\n\n\treturn parseUnit( initialValue, units );\n}\n\n/**\n * Checks if units are defined.\n *\n * @param  units Units to check.\n * @return Whether units are defined.\n */\nexport function hasUnits( units: WPUnitControlUnitList ): boolean {\n\treturn Array.isArray( units ) && !! units.length;\n}\n\n/**\n * Parses a number and unit from a value.\n *\n * @param  initialValue Value to parse\n * @param  units        Units to derive from.\n * @return The extracted number and unit.\n */\nexport function parseUnit(\n\tinitialValue: Value,\n\tunits: WPUnitControlUnitList = ALL_CSS_UNITS\n): [ Value, string ] {\n\tconst value = String( initialValue ).trim();\n\n\tlet num: Value = parseFloat( value );\n\tnum = isNaN( num ) ? '' : num;\n\n\tconst unitMatch = value.match( /[\\d.\\-\\+]*\\s*(.*)/ )[ 1 ];\n\n\tlet unit = unitMatch !== undefined ? unitMatch : '';\n\tunit = unit.toLowerCase();\n\n\tif ( hasUnits( units ) && units !== false ) {\n\t\tconst match = units.find( ( item ) => item.value === unit );\n\t\tunit = match?.value;\n\t} else {\n\t\tunit = DEFAULT_UNIT.value;\n\t}\n\n\treturn [ num, unit ];\n}\n\n/**\n * Parses a number and unit from a value. Validates parsed value, using fallback\n * value if invalid.\n *\n * @param  next          The next value.\n * @param  units         Units to derive from.\n * @param  fallbackValue The fallback value.\n * @param  fallbackUnit  The fallback value.\n * @return The extracted value and unit.\n */\nexport function getValidParsedUnit(\n\tnext: Value,\n\tunits: WPUnitControlUnitList,\n\tfallbackValue: Value,\n\tfallbackUnit: string\n) {\n\tconst [ parsedValue, parsedUnit ] = parseUnit( next, units );\n\tlet baseValue = parsedValue;\n\tlet baseUnit: string;\n\n\t// The parsed value from `parseUnit` should now be either a\n\t// real number or an empty string. If not, use the fallback value.\n\tif ( ! Number.isFinite( parsedValue ) || parsedValue === '' ) {\n\t\tbaseValue = fallbackValue;\n\t}\n\n\tbaseUnit = parsedUnit || fallbackUnit;\n\n\t/**\n\t * If no unit is found, attempt to use the first value from the collection\n\t * of units as a default fallback.\n\t */\n\tif ( hasUnits( units ) && ! baseUnit ) {\n\t\tbaseUnit = units[ 0 ]?.value;\n\t}\n\n\treturn [ baseValue, baseUnit ];\n}\n\n/**\n * Takes a unit value and finds the matching accessibility label for the\n * unit abbreviation.\n *\n * @param  unit Unit value (example: px)\n * @return a11y label for the unit abbreviation\n */\nexport function parseA11yLabelForUnit( unit: string ): string {\n\tconst match = ALL_CSS_UNITS.find( ( item ) => item.value === unit );\n\treturn match?.a11yLabel ? match?.a11yLabel : match?.value;\n}\n\n/**\n * Filters available units based on values defined by the unit setting/property.\n *\n * @param  unitSetting Collection of preferred unit value strings.\n * @param  units       Collection of available unit objects.\n *\n * @return Filtered units based on settings.\n */\nexport function filterUnitsWithSettings(\n\tunitSetting: Array< string > = [],\n\tunits: WPUnitControlUnitList\n): Array< WPUnitControlUnit > {\n\treturn Array.isArray( units )\n\t\t? units.filter( ( unit ) => {\n\t\t\t\treturn unitSetting.includes( unit.value );\n\t\t  } )\n\t\t: [];\n}\n\n/**\n * Custom hook to retrieve and consolidate units setting from add_theme_support().\n * TODO: ideally this hook shouldn't be needed\n * https://github.com/WordPress/gutenberg/pull/31822#discussion_r633280823\n *\n * @param  args                An object containing units, settingPath & defaultUnits.\n * @param  args.units          Collection of all potentially available units.\n * @param  args.availableUnits Collection of unit value strings for filtering available units.\n * @param  args.defaultValues  Collection of default values for defined units. Example: { px: '350', em: '15' }.\n *\n * @return Filtered units based on settings.\n */\nexport const useCustomUnits = ( {\n\tunits,\n\tavailableUnits,\n\tdefaultValues,\n}: {\n\tunits?: WPUnitControlUnitList;\n\tavailableUnits?: Array< string >;\n\tdefaultValues: Record< string, Value >;\n} ): WPUnitControlUnitList => {\n\tunits = units || ALL_CSS_UNITS;\n\tconst usedUnits = filterUnitsWithSettings(\n\t\t! availableUnits ? [] : availableUnits,\n\t\tunits\n\t);\n\n\tif ( defaultValues ) {\n\t\tusedUnits.forEach( ( unit, i ) => {\n\t\t\tif ( defaultValues[ unit.value ] ) {\n\t\t\t\tusedUnits[ i ].default = defaultValues[ unit.value ];\n\t\t\t}\n\t\t} );\n\t}\n\n\treturn usedUnits.length === 0 ? false : usedUnits;\n};\n\n/**\n * Get available units with the unit for the currently selected value\n * prepended if it is not available in the list of units.\n *\n * This is useful to ensure that the current value's unit is always\n * accurately displayed in the UI, even if the intention is to hide\n * the availability of that unit.\n *\n * @param  currentValue Selected value to parse.\n * @param  legacyUnit   Legacy unit value, if currentValue needs it appended.\n * @param  units        List of available units.\n *\n * @return A collection of units containing the unit for the current value.\n */\nexport function getUnitsWithCurrentUnit(\n\tcurrentValue: Value,\n\tlegacyUnit: string | undefined,\n\tunits: Array< WPUnitControlUnit > | false = ALL_CSS_UNITS\n): WPUnitControlUnitList {\n\tif ( ! Array.isArray( units ) ) {\n\t\treturn units;\n\t}\n\n\tconst unitsWithCurrentUnit = [ ...units ];\n\tconst [ , currentUnit ] = getParsedValue(\n\t\tcurrentValue,\n\t\tlegacyUnit,\n\t\tALL_CSS_UNITS\n\t);\n\n\tif (\n\t\tcurrentUnit &&\n\t\t! unitsWithCurrentUnit.some( ( unit ) => unit.value === currentUnit )\n\t) {\n\t\tif ( allUnits[ currentUnit ] ) {\n\t\t\tunitsWithCurrentUnit.unshift( allUnits[ currentUnit ] );\n\t\t}\n\t}\n\n\treturn unitsWithCurrentUnit;\n}\n"]}