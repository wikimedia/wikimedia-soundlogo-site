{"version":3,"sources":["@wordpress/components/src/number-control/index.js"],"names":["classNames","forwardRef","isRTL","Input","inputControlActionTypes","composeStateReducers","add","subtract","roundClamp","useJumpStep","isValueEmpty","NumberControl","__unstableStateReducer","stateReducer","state","className","dragDirection","hideHTMLArrows","isDragEnabled","isShiftStepEnabled","label","max","Infinity","min","required","shiftStep","step","type","typeProp","value","valueProp","props","ref","baseValue","jumpStep","autoComplete","classes","numberControlStateReducer","action","payload","event","currentValue","PRESS_UP","PRESS_DOWN","enableShift","shiftKey","incrementalValue","parseFloat","nextValue","preventDefault","DRAG","delta","x","y","modifier","directionModifier","directionBaseValue","distance","PRESS_ENTER","COMMIT","applyEmptyValue"],"mappings":"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","sourcesContent":["// @ts-nocheck\n/**\n * External dependencies\n */\nimport classNames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { forwardRef } from '@wordpress/element';\nimport { isRTL } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport { Input } from './styles/number-control-styles';\nimport * as inputControlActionTypes from '../input-control/reducer/actions';\nimport { composeStateReducers } from '../input-control/reducer/reducer';\nimport { add, subtract, roundClamp } from '../utils/math';\nimport { useJumpStep } from '../utils/hooks';\nimport { isValueEmpty } from '../utils/values';\n\nexport function NumberControl(\n\t{\n\t\t__unstableStateReducer: stateReducer = ( state ) => state,\n\t\tclassName,\n\t\tdragDirection = 'n',\n\t\thideHTMLArrows = false,\n\t\tisDragEnabled = true,\n\t\tisShiftStepEnabled = true,\n\t\tlabel,\n\t\tmax = Infinity,\n\t\tmin = -Infinity,\n\t\trequired = false,\n\t\tshiftStep = 10,\n\t\tstep = 1,\n\t\ttype: typeProp = 'number',\n\t\tvalue: valueProp,\n\t\t...props\n\t},\n\tref\n) {\n\tconst baseValue = roundClamp( 0, min, max, step );\n\n\tconst jumpStep = useJumpStep( {\n\t\tstep,\n\t\tshiftStep,\n\t\tisShiftStepEnabled,\n\t} );\n\n\tconst autoComplete = typeProp === 'number' ? 'off' : null;\n\tconst classes = classNames( 'components-number-control', className );\n\n\t/**\n\t * \"Middleware\" function that intercepts updates from InputControl.\n\t * This allows us to tap into actions to transform the (next) state for\n\t * InputControl.\n\t *\n\t * @param {Object} state  State from InputControl\n\t * @param {Object} action Action triggering state change\n\t * @return {Object} The updated state to apply to InputControl\n\t */\n\tconst numberControlStateReducer = ( state, action ) => {\n\t\tconst { type, payload } = action;\n\t\tconst event = payload?.event;\n\t\tconst currentValue = state.value;\n\n\t\t/**\n\t\t * Handles custom UP and DOWN Keyboard events\n\t\t */\n\t\tif (\n\t\t\ttype === inputControlActionTypes.PRESS_UP ||\n\t\t\ttype === inputControlActionTypes.PRESS_DOWN\n\t\t) {\n\t\t\tconst enableShift = event.shiftKey && isShiftStepEnabled;\n\n\t\t\tconst incrementalValue = enableShift\n\t\t\t\t? parseFloat( shiftStep ) * parseFloat( step )\n\t\t\t\t: parseFloat( step );\n\t\t\tlet nextValue = isValueEmpty( currentValue )\n\t\t\t\t? baseValue\n\t\t\t\t: currentValue;\n\n\t\t\tif ( event?.preventDefault ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\n\t\t\tif ( type === inputControlActionTypes.PRESS_UP ) {\n\t\t\t\tnextValue = add( nextValue, incrementalValue );\n\t\t\t}\n\n\t\t\tif ( type === inputControlActionTypes.PRESS_DOWN ) {\n\t\t\t\tnextValue = subtract( nextValue, incrementalValue );\n\t\t\t}\n\n\t\t\tnextValue = roundClamp( nextValue, min, max, incrementalValue );\n\n\t\t\tstate.value = nextValue;\n\t\t}\n\n\t\t/**\n\t\t * Handles drag to update events\n\t\t */\n\t\tif ( type === inputControlActionTypes.DRAG && isDragEnabled ) {\n\t\t\tconst { delta, shiftKey } = payload;\n\t\t\tconst [ x, y ] = delta;\n\t\t\tconst modifier = shiftKey\n\t\t\t\t? parseFloat( shiftStep ) * parseFloat( step )\n\t\t\t\t: parseFloat( step );\n\n\t\t\tlet directionModifier;\n\t\t\tlet directionBaseValue;\n\n\t\t\tswitch ( dragDirection ) {\n\t\t\t\tcase 'n':\n\t\t\t\t\tdirectionBaseValue = y;\n\t\t\t\t\tdirectionModifier = -1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'e':\n\t\t\t\t\tdirectionBaseValue = x;\n\t\t\t\t\tdirectionModifier = isRTL() ? -1 : 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 's':\n\t\t\t\t\tdirectionBaseValue = y;\n\t\t\t\t\tdirectionModifier = 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'w':\n\t\t\t\t\tdirectionBaseValue = x;\n\t\t\t\t\tdirectionModifier = isRTL() ? 1 : -1;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst distance = directionBaseValue * modifier * directionModifier;\n\t\t\tlet nextValue;\n\n\t\t\tif ( distance !== 0 ) {\n\t\t\t\tnextValue = roundClamp(\n\t\t\t\t\tadd( currentValue, distance ),\n\t\t\t\t\tmin,\n\t\t\t\t\tmax,\n\t\t\t\t\tmodifier\n\t\t\t\t);\n\n\t\t\t\tstate.value = nextValue;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Handles commit (ENTER key press or on blur if isPressEnterToChange)\n\t\t */\n\t\tif (\n\t\t\ttype === inputControlActionTypes.PRESS_ENTER ||\n\t\t\ttype === inputControlActionTypes.COMMIT\n\t\t) {\n\t\t\tconst applyEmptyValue = required === false && currentValue === '';\n\n\t\t\tstate.value = applyEmptyValue\n\t\t\t\t? currentValue\n\t\t\t\t: roundClamp( currentValue, min, max, step );\n\t\t}\n\n\t\treturn state;\n\t};\n\n\treturn (\n\t\t<Input\n\t\t\tautoComplete={ autoComplete }\n\t\t\tinputMode=\"numeric\"\n\t\t\t{ ...props }\n\t\t\tclassName={ classes }\n\t\t\tdragDirection={ dragDirection }\n\t\t\thideHTMLArrows={ hideHTMLArrows }\n\t\t\tisDragEnabled={ isDragEnabled }\n\t\t\tlabel={ label }\n\t\t\tmax={ max }\n\t\t\tmin={ min }\n\t\t\tref={ ref }\n\t\t\trequired={ required }\n\t\t\tstep={ jumpStep }\n\t\t\ttype={ typeProp }\n\t\t\tvalue={ valueProp }\n\t\t\t__unstableStateReducer={ composeStateReducers(\n\t\t\t\tnumberControlStateReducer,\n\t\t\t\tstateReducer\n\t\t\t) }\n\t\t/>\n\t);\n}\n\nexport default forwardRef( NumberControl );\n"]}