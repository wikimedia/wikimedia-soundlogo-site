{"version":3,"sources":["@wordpress/block-editor/src/components/list-view/use-list-view-client-ids.js"],"names":["useSelect","isClientIdSelected","store","blockEditorStore","useListViewClientIdsTree","blocks","selectedClientIds","showOnlyCurrentHierarchy","select","getBlockHierarchyRootClientId","__unstableGetClientIdsTree","__unstableGetClientIdWithClientIdsTree","isSingleBlockSelected","Array","isArray","rootBlock","hasHierarchy","clientId","innerBlocks","length","useListViewClientIds","__experimentalPersistentListViewFeatures","draggedClientIds","getSelectedBlockClientId","getSelectedBlockClientIds","getDraggedBlockClientIds","clientIdsTree"],"mappings":"AAAA;AACA;AACA;AAEA,SAASA,SAAT,QAA0B,iBAA1B;AAEA;AACA;AACA;;AACA,SAASC,kBAAT,QAAmC,SAAnC;AACA,SAASC,KAAK,IAAIC,gBAAlB,QAA0C,aAA1C;;AAEA,MAAMC,wBAAwB,GAAG,CAChCC,MADgC,EAEhCC,iBAFgC,EAGhCC,wBAHgC,KAKhCP,SAAS,CACNQ,MAAF,IAAc;AACb,QAAM;AACLC,IAAAA,6BADK;AAELC,IAAAA,0BAFK;AAGLC,IAAAA;AAHK,MAIFH,MAAM,CAAEL,gBAAF,CAJV;;AAMA,MAAKE,MAAL,EAAc;AACb,WAAOA,MAAP;AACA;;AAED,QAAMO,qBAAqB,GAC1BN,iBAAiB,IAAI,CAAEO,KAAK,CAACC,OAAN,CAAeR,iBAAf,CADxB;;AAEA,MAAK,CAAEC,wBAAF,IAA8B,CAAEK,qBAArC,EAA6D;AAC5D,WAAOF,0BAA0B,EAAjC;AACA;;AAED,QAAMK,SAAS,GAAGJ,sCAAsC,CACvDF,6BAA6B,CAAEH,iBAAF,CAD0B,CAAxD;;AAGA,MAAK,CAAES,SAAP,EAAmB;AAClB,WAAOL,0BAA0B,EAAjC;AACA;;AAED,QAAMM,YAAY,GACjB,CAAEf,kBAAkB,CAAEc,SAAS,CAACE,QAAZ,EAAsBX,iBAAtB,CAApB,IACES,SAAS,CAACG,WAAV,IAAyBH,SAAS,CAACG,WAAV,CAAsBC,MAAtB,KAAiC,CAF7D;;AAGA,MAAKH,YAAL,EAAoB;AACnB,WAAO,CAAED,SAAF,CAAP;AACA;;AAED,SAAOL,0BAA0B,EAAjC;AACA,CAjCO,EAkCR,CAAEL,MAAF,EAAUC,iBAAV,EAA6BC,wBAA7B,CAlCQ,CALV;;AA0CA,eAAe,SAASa,oBAAT,CACdf,MADc,EAEdE,wBAFc,EAGdc,wCAHc,EAIb;AACD,QAAM;AAAEf,IAAAA,iBAAF;AAAqBgB,IAAAA;AAArB,MAA0CtB,SAAS,CACtDQ,MAAF,IAAc;AACb,UAAM;AACLe,MAAAA,wBADK;AAELC,MAAAA,yBAFK;AAGLC,MAAAA;AAHK,QAIFjB,MAAM,CAAEL,gBAAF,CAJV;;AAMA,QAAKkB,wCAAL,EAAgD;AAC/C,aAAO;AACNf,QAAAA,iBAAiB,EAAEkB,yBAAyB,EADtC;AAENF,QAAAA,gBAAgB,EAAEG,wBAAwB;AAFpC,OAAP;AAIA;;AAED,WAAO;AACNnB,MAAAA,iBAAiB,EAAEiB,wBAAwB,EADrC;AAEND,MAAAA,gBAAgB,EAAEG,wBAAwB;AAFpC,KAAP;AAIA,GAnBuD,EAoBxD,CAAEJ,wCAAF,CApBwD,CAAzD;AAsBA,QAAMK,aAAa,GAAGtB,wBAAwB,CAC7CC,MAD6C,EAE7CC,iBAF6C,EAG7CC,wBAH6C,CAA9C;AAKA,SAAO;AAAEmB,IAAAA,aAAF;AAAiBpB,IAAAA,iBAAjB;AAAoCgB,IAAAA;AAApC,GAAP;AACA","sourcesContent":["/**\n * WordPress dependencies\n */\n\nimport { useSelect } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport { isClientIdSelected } from './utils';\nimport { store as blockEditorStore } from '../../store';\n\nconst useListViewClientIdsTree = (\n\tblocks,\n\tselectedClientIds,\n\tshowOnlyCurrentHierarchy\n) =>\n\tuseSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetBlockHierarchyRootClientId,\n\t\t\t\t__unstableGetClientIdsTree,\n\t\t\t\t__unstableGetClientIdWithClientIdsTree,\n\t\t\t} = select( blockEditorStore );\n\n\t\t\tif ( blocks ) {\n\t\t\t\treturn blocks;\n\t\t\t}\n\n\t\t\tconst isSingleBlockSelected =\n\t\t\t\tselectedClientIds && ! Array.isArray( selectedClientIds );\n\t\t\tif ( ! showOnlyCurrentHierarchy || ! isSingleBlockSelected ) {\n\t\t\t\treturn __unstableGetClientIdsTree();\n\t\t\t}\n\n\t\t\tconst rootBlock = __unstableGetClientIdWithClientIdsTree(\n\t\t\t\tgetBlockHierarchyRootClientId( selectedClientIds )\n\t\t\t);\n\t\t\tif ( ! rootBlock ) {\n\t\t\t\treturn __unstableGetClientIdsTree();\n\t\t\t}\n\n\t\t\tconst hasHierarchy =\n\t\t\t\t! isClientIdSelected( rootBlock.clientId, selectedClientIds ) ||\n\t\t\t\t( rootBlock.innerBlocks && rootBlock.innerBlocks.length !== 0 );\n\t\t\tif ( hasHierarchy ) {\n\t\t\t\treturn [ rootBlock ];\n\t\t\t}\n\n\t\t\treturn __unstableGetClientIdsTree();\n\t\t},\n\t\t[ blocks, selectedClientIds, showOnlyCurrentHierarchy ]\n\t);\n\nexport default function useListViewClientIds(\n\tblocks,\n\tshowOnlyCurrentHierarchy,\n\t__experimentalPersistentListViewFeatures\n) {\n\tconst { selectedClientIds, draggedClientIds } = useSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetSelectedBlockClientId,\n\t\t\t\tgetSelectedBlockClientIds,\n\t\t\t\tgetDraggedBlockClientIds,\n\t\t\t} = select( blockEditorStore );\n\n\t\t\tif ( __experimentalPersistentListViewFeatures ) {\n\t\t\t\treturn {\n\t\t\t\t\tselectedClientIds: getSelectedBlockClientIds(),\n\t\t\t\t\tdraggedClientIds: getDraggedBlockClientIds(),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tselectedClientIds: getSelectedBlockClientId(),\n\t\t\t\tdraggedClientIds: getDraggedBlockClientIds(),\n\t\t\t};\n\t\t},\n\t\t[ __experimentalPersistentListViewFeatures ]\n\t);\n\tconst clientIdsTree = useListViewClientIdsTree(\n\t\tblocks,\n\t\tselectedClientIds,\n\t\tshowOnlyCurrentHierarchy\n\t);\n\treturn { clientIdsTree, selectedClientIds, draggedClientIds };\n}\n"]}