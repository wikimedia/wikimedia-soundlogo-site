{"version":3,"sources":["@wordpress/components/src/tools-panel/tools-panel-item/hook.ts"],"names":["usePrevious","useCallback","useEffect","useMemo","styles","useToolsPanelContext","useContextSystem","useCx","useToolsPanelItem","props","className","hasValue","isShownByDefault","label","panelId","resetAllFilter","onDeselect","onSelect","otherProps","cx","classes","ToolsPanelItem","currentPanelId","menuItems","registerPanelItem","deregisterPanelItem","flagItemCustomization","isResetting","hasValueCallback","resetAllFilterCallback","isValueSet","wasValueSet","menuGroup","isMenuItemChecked","wasMenuItemChecked","isShown","undefined"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { usePrevious } from '@wordpress/compose';\nimport { useCallback, useEffect, useMemo } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport * as styles from '../styles';\nimport { useToolsPanelContext } from '../context';\nimport { useContextSystem, WordPressComponentProps } from '../../ui/context';\nimport { useCx } from '../../utils/hooks/use-cx';\nimport type { ToolsPanelItemProps } from '../types';\n\nexport function useToolsPanelItem(\n\tprops: WordPressComponentProps< ToolsPanelItemProps, 'div' >\n) {\n\tconst {\n\t\tclassName,\n\t\thasValue,\n\t\tisShownByDefault,\n\t\tlabel,\n\t\tpanelId,\n\t\tresetAllFilter,\n\t\tonDeselect,\n\t\tonSelect,\n\t\t...otherProps\n\t} = useContextSystem( props, 'ToolsPanelItem' );\n\n\tconst cx = useCx();\n\tconst classes = useMemo( () => {\n\t\treturn cx( styles.ToolsPanelItem, className );\n\t}, [ className ] );\n\n\tconst {\n\t\tpanelId: currentPanelId,\n\t\tmenuItems,\n\t\tregisterPanelItem,\n\t\tderegisterPanelItem,\n\t\tflagItemCustomization,\n\t\tisResetting,\n\t} = useToolsPanelContext();\n\n\tconst hasValueCallback = useCallback( hasValue, [ panelId ] );\n\tconst resetAllFilterCallback = useCallback( resetAllFilter, [ panelId ] );\n\n\t// Registering the panel item allows the panel to include it in its\n\t// automatically generated menu and determine its initial checked status.\n\tuseEffect( () => {\n\t\tif ( currentPanelId === panelId ) {\n\t\t\tregisterPanelItem( {\n\t\t\t\thasValue: hasValueCallback,\n\t\t\t\tisShownByDefault,\n\t\t\t\tlabel,\n\t\t\t\tresetAllFilter: resetAllFilterCallback,\n\t\t\t\tpanelId,\n\t\t\t} );\n\t\t}\n\n\t\treturn () => deregisterPanelItem( label );\n\t}, [\n\t\tcurrentPanelId,\n\t\tpanelId,\n\t\tisShownByDefault,\n\t\tlabel,\n\t\thasValueCallback,\n\t\tresetAllFilterCallback,\n\t] );\n\n\tconst isValueSet = hasValue();\n\tconst wasValueSet = usePrevious( isValueSet );\n\n\t// If this item represents a default control it will need to notify the\n\t// panel when a custom value has been set.\n\tuseEffect( () => {\n\t\tif ( isShownByDefault && isValueSet && ! wasValueSet ) {\n\t\t\tflagItemCustomization( label );\n\t\t}\n\t}, [ isValueSet, wasValueSet, isShownByDefault, label ] );\n\n\t// Note: `label` is used as a key when building menu item state in\n\t// `ToolsPanel`.\n\tconst menuGroup = isShownByDefault ? 'default' : 'optional';\n\tconst isMenuItemChecked = menuItems?.[ menuGroup ]?.[ label ];\n\tconst wasMenuItemChecked = usePrevious( isMenuItemChecked );\n\n\t// Determine if the panel item's corresponding menu is being toggled and\n\t// trigger appropriate callback if it is.\n\tuseEffect( () => {\n\t\tif ( isResetting || currentPanelId !== panelId ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( isMenuItemChecked && ! isValueSet && ! wasMenuItemChecked ) {\n\t\t\tonSelect?.();\n\t\t}\n\n\t\tif ( ! isMenuItemChecked && wasMenuItemChecked ) {\n\t\t\tonDeselect?.();\n\t\t}\n\t}, [\n\t\tcurrentPanelId,\n\t\tisMenuItemChecked,\n\t\tisResetting,\n\t\tisValueSet,\n\t\tpanelId,\n\t\twasMenuItemChecked,\n\t] );\n\n\t// The item is shown if it is a default control regardless of whether it\n\t// has a value. Optional items are shown when they are checked or have\n\t// a value.\n\tconst isShown = isShownByDefault\n\t\t? menuItems?.[ menuGroup ]?.[ label ] !== undefined\n\t\t: isMenuItemChecked;\n\n\treturn {\n\t\t...otherProps,\n\t\tisShown,\n\t\tclassName: classes,\n\t};\n}\n"]}