{"version":3,"sources":["@wordpress/edit-post/src/components/header/template-title/delete-template.js"],"names":["DeleteTemplate","clearSelectedBlock","blockEditorStore","setIsEditingTemplate","editPostStore","getEditorSettings","editorStore","updateEditorSettings","editPost","deleteEntityRecord","coreStore","template","select","isEditingTemplate","getEditedPostTemplate","_isEditing","wp_id","templateTitle","slug","title","window","confirm","settings","newAvailableTemplates","availableTemplates","_title","id"],"mappings":";;;;;;;;;AAGA;;AAKA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAKA;;AAlBA;AACA;AACA;;AAGA;AACA;AACA;;AAQA;AACA;AACA;AAGe,SAASA,cAAT,GAA0B;AACxC,QAAM;AAAEC,IAAAA;AAAF,MAAyB,uBAAaC,kBAAb,CAA/B;AACA,QAAM;AAAEC,IAAAA;AAAF,MAA2B,uBAAaC,YAAb,CAAjC;AACA,QAAM;AAAEC,IAAAA;AAAF,MAAwB,qBAAWC,aAAX,CAA9B;AACA,QAAM;AAAEC,IAAAA,oBAAF;AAAwBC,IAAAA;AAAxB,MAAqC,uBAAaF,aAAb,CAA3C;AACA,QAAM;AAAEG,IAAAA;AAAF,MAAyB,uBAAaC,eAAb,CAA/B;AACA,QAAM;AAAEC,IAAAA;AAAF,MAAe,qBAAaC,MAAF,IAAc;AAC7C,UAAM;AAAEC,MAAAA,iBAAF;AAAqBC,MAAAA;AAArB,QAA+CF,MAAM,CAC1DR,YAD0D,CAA3D;;AAGA,UAAMW,UAAU,GAAGF,iBAAiB,EAApC;;AACA,WAAO;AACNF,MAAAA,QAAQ,EAAEI,UAAU,GAAGD,qBAAqB,EAAxB,GAA6B;AAD3C,KAAP;AAGA,GARoB,EAQlB,EARkB,CAArB;;AAUA,MAAK,CAAEH,QAAF,IAAc,CAAEA,QAAQ,CAACK,KAA9B,EAAsC;AACrC,WAAO,IAAP;AACA;;AACD,MAAIC,aAAa,GAAGN,QAAQ,CAACO,IAA7B;;AACA,MAAKP,QAAL,aAAKA,QAAL,eAAKA,QAAQ,CAAEQ,KAAf,EAAuB;AACtBF,IAAAA,aAAa,GAAGN,QAAQ,CAACQ,KAAzB;AACA;;AAED,SACC,4BAAC,qBAAD;AAAW,IAAA,SAAS,EAAC;AAArB,KACC,4BAAC,oBAAD;AACC,IAAA,SAAS,EAAC,qDADX;AAEC,IAAA,aAAa,MAFd;AAGC,IAAA,OAAO,EAAC,WAHT;AAIC,kBAAa,cAAI,iBAAJ,CAJd;AAKC,IAAA,OAAO,EAAG,MAAM;AACf,WACC;AACAC,MAAAA,MAAM,CAACC,OAAP,CACC;AACC;AACA,oBACC,0FADD,CAFD,EAKCJ,aALD,CADD,CAFD,EAWE;AACDhB,QAAAA,kBAAkB;AAClBE,QAAAA,oBAAoB,CAAE,KAAF,CAApB;AAEAK,QAAAA,QAAQ,CAAE;AACTG,UAAAA,QAAQ,EAAE;AADD,SAAF,CAAR;AAGA,cAAMW,QAAQ,GAAGjB,iBAAiB,EAAlC;AACA,cAAMkB,qBAAqB,GAAG,oBAC7BD,QAAQ,CAACE,kBADoB,EAE7B,CAAEC,MAAF,EAAUC,EAAV,KAAkB;AACjB,iBAAOA,EAAE,KAAKf,QAAQ,CAACO,IAAvB;AACA,SAJ4B,CAA9B;AAMAX,QAAAA,oBAAoB,CAAE,EACrB,GAAGe,QADkB;AAErBE,UAAAA,kBAAkB,EAAED;AAFC,SAAF,CAApB;AAIAd,QAAAA,kBAAkB,CACjB,UADiB,EAEjB,aAFiB,EAGjBE,QAAQ,CAACe,EAHQ,CAAlB;AAKA;AACD;AAzCF,KA2CG,cAAI,iBAAJ,CA3CH,CADD,CADD;AAiDA","sourcesContent":["/**\n * External dependencies\n */\nimport { pickBy } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\nimport { MenuGroup, MenuItem } from '@wordpress/components';\nimport { store as blockEditorStore } from '@wordpress/block-editor';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { store as editorStore } from '@wordpress/editor';\nimport { store as coreStore } from '@wordpress/core-data';\n\n/**\n * Internal dependencies\n */\nimport { store as editPostStore } from '../../../store';\n\nexport default function DeleteTemplate() {\n\tconst { clearSelectedBlock } = useDispatch( blockEditorStore );\n\tconst { setIsEditingTemplate } = useDispatch( editPostStore );\n\tconst { getEditorSettings } = useSelect( editorStore );\n\tconst { updateEditorSettings, editPost } = useDispatch( editorStore );\n\tconst { deleteEntityRecord } = useDispatch( coreStore );\n\tconst { template } = useSelect( ( select ) => {\n\t\tconst { isEditingTemplate, getEditedPostTemplate } = select(\n\t\t\teditPostStore\n\t\t);\n\t\tconst _isEditing = isEditingTemplate();\n\t\treturn {\n\t\t\ttemplate: _isEditing ? getEditedPostTemplate() : null,\n\t\t};\n\t}, [] );\n\n\tif ( ! template || ! template.wp_id ) {\n\t\treturn null;\n\t}\n\tlet templateTitle = template.slug;\n\tif ( template?.title ) {\n\t\ttemplateTitle = template.title;\n\t}\n\n\treturn (\n\t\t<MenuGroup className=\"edit-post-template-top-area__second-menu-group\">\n\t\t\t<MenuItem\n\t\t\t\tclassName=\"edit-post-template-top-area__delete-template-button\"\n\t\t\t\tisDestructive\n\t\t\t\tvariant=\"secondary\"\n\t\t\t\taria-label={ __( 'Delete template' ) }\n\t\t\t\tonClick={ () => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t// eslint-disable-next-line no-alert\n\t\t\t\t\t\twindow.confirm(\n\t\t\t\t\t\t\tsprintf(\n\t\t\t\t\t\t\t\t/* translators: %s: template name */\n\t\t\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t\t\t'Are you sure you want to delete the %s template? It may be used by other pages or posts.'\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\ttemplateTitle\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\tclearSelectedBlock();\n\t\t\t\t\t\tsetIsEditingTemplate( false );\n\n\t\t\t\t\t\teditPost( {\n\t\t\t\t\t\t\ttemplate: '',\n\t\t\t\t\t\t} );\n\t\t\t\t\t\tconst settings = getEditorSettings();\n\t\t\t\t\t\tconst newAvailableTemplates = pickBy(\n\t\t\t\t\t\t\tsettings.availableTemplates,\n\t\t\t\t\t\t\t( _title, id ) => {\n\t\t\t\t\t\t\t\treturn id !== template.slug;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t\tupdateEditorSettings( {\n\t\t\t\t\t\t\t...settings,\n\t\t\t\t\t\t\tavailableTemplates: newAvailableTemplates,\n\t\t\t\t\t\t} );\n\t\t\t\t\t\tdeleteEntityRecord(\n\t\t\t\t\t\t\t'postType',\n\t\t\t\t\t\t\t'wp_template',\n\t\t\t\t\t\t\ttemplate.id\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} }\n\t\t\t>\n\t\t\t\t{ __( 'Delete template' ) }\n\t\t\t</MenuItem>\n\t\t</MenuGroup>\n\t);\n}\n"]}