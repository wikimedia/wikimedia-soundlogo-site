{"version":3,"sources":["@wordpress/edit-post/src/components/header/template-title/delete-template.js"],"names":["pickBy","__","sprintf","MenuGroup","MenuItem","store","blockEditorStore","useDispatch","useSelect","editorStore","coreStore","editPostStore","DeleteTemplate","clearSelectedBlock","setIsEditingTemplate","getEditorSettings","updateEditorSettings","editPost","deleteEntityRecord","template","select","isEditingTemplate","getEditedPostTemplate","_isEditing","wp_id","templateTitle","slug","title","window","confirm","settings","newAvailableTemplates","availableTemplates","_title","id"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { pickBy } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\nimport { MenuGroup, MenuItem } from '@wordpress/components';\nimport { store as blockEditorStore } from '@wordpress/block-editor';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { store as editorStore } from '@wordpress/editor';\nimport { store as coreStore } from '@wordpress/core-data';\n\n/**\n * Internal dependencies\n */\nimport { store as editPostStore } from '../../../store';\n\nexport default function DeleteTemplate() {\n\tconst { clearSelectedBlock } = useDispatch( blockEditorStore );\n\tconst { setIsEditingTemplate } = useDispatch( editPostStore );\n\tconst { getEditorSettings } = useSelect( editorStore );\n\tconst { updateEditorSettings, editPost } = useDispatch( editorStore );\n\tconst { deleteEntityRecord } = useDispatch( coreStore );\n\tconst { template } = useSelect( ( select ) => {\n\t\tconst { isEditingTemplate, getEditedPostTemplate } = select(\n\t\t\teditPostStore\n\t\t);\n\t\tconst _isEditing = isEditingTemplate();\n\t\treturn {\n\t\t\ttemplate: _isEditing ? getEditedPostTemplate() : null,\n\t\t};\n\t}, [] );\n\n\tif ( ! template || ! template.wp_id ) {\n\t\treturn null;\n\t}\n\tlet templateTitle = template.slug;\n\tif ( template?.title ) {\n\t\ttemplateTitle = template.title;\n\t}\n\n\treturn (\n\t\t<MenuGroup className=\"edit-post-template-top-area__second-menu-group\">\n\t\t\t<MenuItem\n\t\t\t\tclassName=\"edit-post-template-top-area__delete-template-button\"\n\t\t\t\tisDestructive\n\t\t\t\tvariant=\"secondary\"\n\t\t\t\taria-label={ __( 'Delete template' ) }\n\t\t\t\tonClick={ () => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t// eslint-disable-next-line no-alert\n\t\t\t\t\t\twindow.confirm(\n\t\t\t\t\t\t\tsprintf(\n\t\t\t\t\t\t\t\t/* translators: %s: template name */\n\t\t\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t\t\t'Are you sure you want to delete the %s template? It may be used by other pages or posts.'\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\ttemplateTitle\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\tclearSelectedBlock();\n\t\t\t\t\t\tsetIsEditingTemplate( false );\n\n\t\t\t\t\t\teditPost( {\n\t\t\t\t\t\t\ttemplate: '',\n\t\t\t\t\t\t} );\n\t\t\t\t\t\tconst settings = getEditorSettings();\n\t\t\t\t\t\tconst newAvailableTemplates = pickBy(\n\t\t\t\t\t\t\tsettings.availableTemplates,\n\t\t\t\t\t\t\t( _title, id ) => {\n\t\t\t\t\t\t\t\treturn id !== template.slug;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t\tupdateEditorSettings( {\n\t\t\t\t\t\t\t...settings,\n\t\t\t\t\t\t\tavailableTemplates: newAvailableTemplates,\n\t\t\t\t\t\t} );\n\t\t\t\t\t\tdeleteEntityRecord(\n\t\t\t\t\t\t\t'postType',\n\t\t\t\t\t\t\t'wp_template',\n\t\t\t\t\t\t\ttemplate.id\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} }\n\t\t\t>\n\t\t\t\t{ __( 'Delete template' ) }\n\t\t\t</MenuItem>\n\t\t</MenuGroup>\n\t);\n}\n"]}