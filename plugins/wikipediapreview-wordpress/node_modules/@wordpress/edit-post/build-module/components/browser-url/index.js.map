{"version":3,"sources":["@wordpress/edit-post/src/components/browser-url/index.js"],"names":["Component","withSelect","addQueryArgs","store","editorStore","getPostEditURL","postId","post","action","getPostTrashedURL","postType","trashed","post_type","ids","BrowserURL","constructor","arguments","state","historyId","componentDidUpdate","prevProps","postStatus","isSavingPost","props","setTrashURL","setBrowserURL","window","location","href","history","replaceState","id","setState","render","select","getCurrentPost","status","type","isTemplate","includes","wp_id"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { withSelect } from '@wordpress/data';\nimport { addQueryArgs } from '@wordpress/url';\nimport { store as editorStore } from '@wordpress/editor';\n\n/**\n * Returns the Post's Edit URL.\n *\n * @param {number} postId Post ID.\n *\n * @return {string} Post edit URL.\n */\nexport function getPostEditURL( postId ) {\n\treturn addQueryArgs( 'post.php', { post: postId, action: 'edit' } );\n}\n\n/**\n * Returns the Post's Trashed URL.\n *\n * @param {number} postId   Post ID.\n * @param {string} postType Post Type.\n *\n * @return {string} Post trashed URL.\n */\nexport function getPostTrashedURL( postId, postType ) {\n\treturn addQueryArgs( 'edit.php', {\n\t\ttrashed: 1,\n\t\tpost_type: postType,\n\t\tids: postId,\n\t} );\n}\n\nexport class BrowserURL extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.state = {\n\t\t\thistoryId: null,\n\t\t};\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tconst { postId, postStatus, postType, isSavingPost } = this.props;\n\t\tconst { historyId } = this.state;\n\n\t\t// Posts are still dirty while saving so wait for saving to finish\n\t\t// to avoid the unsaved changes warning when trashing posts.\n\t\tif ( postStatus === 'trash' && ! isSavingPost ) {\n\t\t\tthis.setTrashURL( postId, postType );\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\t( postId !== prevProps.postId || postId !== historyId ) &&\n\t\t\tpostStatus !== 'auto-draft' &&\n\t\t\tpostId\n\t\t) {\n\t\t\tthis.setBrowserURL( postId );\n\t\t}\n\t}\n\n\t/**\n\t * Navigates the browser to the post trashed URL to show a notice about the trashed post.\n\t *\n\t * @param {number} postId   Post ID.\n\t * @param {string} postType Post Type.\n\t */\n\tsetTrashURL( postId, postType ) {\n\t\twindow.location.href = getPostTrashedURL( postId, postType );\n\t}\n\n\t/**\n\t * Replaces the browser URL with a post editor link for the given post ID.\n\t *\n\t * Note it is important that, since this function may be called when the\n\t * editor first loads, the result generated `getPostEditURL` matches that\n\t * produced by the server. Otherwise, the URL will change unexpectedly.\n\t *\n\t * @param {number} postId Post ID for which to generate post editor URL.\n\t */\n\tsetBrowserURL( postId ) {\n\t\twindow.history.replaceState(\n\t\t\t{ id: postId },\n\t\t\t'Post ' + postId,\n\t\t\tgetPostEditURL( postId )\n\t\t);\n\n\t\tthis.setState( () => ( {\n\t\t\thistoryId: postId,\n\t\t} ) );\n\t}\n\n\trender() {\n\t\treturn null;\n\t}\n}\n\nexport default withSelect( ( select ) => {\n\tconst { getCurrentPost, isSavingPost } = select( editorStore );\n\tconst post = getCurrentPost();\n\tlet { id, status, type } = post;\n\tconst isTemplate = [ 'wp_template', 'wp_template_part' ].includes( type );\n\tif ( isTemplate ) {\n\t\tid = post.wp_id;\n\t}\n\n\treturn {\n\t\tpostId: id,\n\t\tpostStatus: status,\n\t\tpostType: type,\n\t\tisSavingPost: isSavingPost(),\n\t};\n} )( BrowserURL );\n"]}