{"version":3,"sources":["@wordpress/components/src/modal/index.js"],"names":["classnames","createPortal","useEffect","useRef","useInstanceId","useFocusReturn","useFocusOnMount","__experimentalUseFocusOutside","useFocusOutside","useConstrainedTabbing","useMergeRefs","deprecated","ESCAPE","__","closeSmall","ariaHelper","Button","openModalCount","Modal","bodyOpenClassName","role","title","focusOnMount","shouldCloseOnEsc","shouldCloseOnClickOutside","isDismissable","isDismissible","aria","labelledby","describedby","onRequestClose","icon","closeButtonLabel","children","style","overlayClassName","className","contentLabel","onKeyDown","ref","instanceId","headingId","focusOnMountRef","constrainedTabbingRef","focusReturnRef","focusOutsideProps","hideApp","current","document","body","classList","add","remove","showApp","since","alternative","handleEscapeKeyDown","event","keyCode","defaultPrevented","preventDefault"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { createPortal, useEffect, useRef } from '@wordpress/element';\nimport {\n\tuseInstanceId,\n\tuseFocusReturn,\n\tuseFocusOnMount,\n\t__experimentalUseFocusOutside as useFocusOutside,\n\tuseConstrainedTabbing,\n\tuseMergeRefs,\n} from '@wordpress/compose';\nimport deprecated from '@wordpress/deprecated';\nimport { ESCAPE } from '@wordpress/keycodes';\nimport { __ } from '@wordpress/i18n';\nimport { closeSmall } from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport * as ariaHelper from './aria-helper';\nimport Button from '../button';\n\n// Used to count the number of open modals.\nlet openModalCount = 0;\n\nexport default function Modal( {\n\tbodyOpenClassName = 'modal-open',\n\trole = 'dialog',\n\ttitle = null,\n\tfocusOnMount = true,\n\tshouldCloseOnEsc = true,\n\tshouldCloseOnClickOutside = true,\n\tisDismissable, // Deprecated\n\tisDismissible = isDismissable || true,\n\t/* accessibility */\n\taria = {\n\t\tlabelledby: null,\n\t\tdescribedby: null,\n\t},\n\tonRequestClose,\n\ticon,\n\tcloseButtonLabel,\n\tchildren,\n\tstyle,\n\toverlayClassName,\n\tclassName,\n\tcontentLabel,\n\tonKeyDown,\n} ) {\n\tconst ref = useRef();\n\tconst instanceId = useInstanceId( Modal );\n\tconst headingId = title\n\t\t? `components-modal-header-${ instanceId }`\n\t\t: aria.labelledby;\n\tconst focusOnMountRef = useFocusOnMount( focusOnMount );\n\tconst constrainedTabbingRef = useConstrainedTabbing();\n\tconst focusReturnRef = useFocusReturn();\n\tconst focusOutsideProps = useFocusOutside( onRequestClose );\n\n\tuseEffect( () => {\n\t\topenModalCount++;\n\n\t\tif ( openModalCount === 1 ) {\n\t\t\tariaHelper.hideApp( ref.current );\n\t\t\tdocument.body.classList.add( bodyOpenClassName );\n\t\t}\n\n\t\treturn () => {\n\t\t\topenModalCount--;\n\n\t\t\tif ( openModalCount === 0 ) {\n\t\t\t\tdocument.body.classList.remove( bodyOpenClassName );\n\t\t\t\tariaHelper.showApp();\n\t\t\t}\n\t\t};\n\t}, [] );\n\n\tif ( isDismissable ) {\n\t\tdeprecated( 'isDismissable prop of the Modal component', {\n\t\t\tsince: '5.4',\n\t\t\talternative: 'isDismissible prop (renamed) of the Modal component',\n\t\t} );\n\t}\n\n\tfunction handleEscapeKeyDown( event ) {\n\t\tif (\n\t\t\tshouldCloseOnEsc &&\n\t\t\tevent.keyCode === ESCAPE &&\n\t\t\t! event.defaultPrevented\n\t\t) {\n\t\t\tevent.preventDefault();\n\t\t\tif ( onRequestClose ) {\n\t\t\t\tonRequestClose( event );\n\t\t\t}\n\t\t}\n\t}\n\n\treturn createPortal(\n\t\t// eslint-disable-next-line jsx-a11y/no-static-element-interactions\n\t\t<div\n\t\t\tref={ ref }\n\t\t\tclassName={ classnames(\n\t\t\t\t'components-modal__screen-overlay',\n\t\t\t\toverlayClassName\n\t\t\t) }\n\t\t\tonKeyDown={ handleEscapeKeyDown }\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName={ classnames( 'components-modal__frame', className ) }\n\t\t\t\tstyle={ style }\n\t\t\t\tref={ useMergeRefs( [\n\t\t\t\t\tconstrainedTabbingRef,\n\t\t\t\t\tfocusReturnRef,\n\t\t\t\t\tfocusOnMountRef,\n\t\t\t\t] ) }\n\t\t\t\trole={ role }\n\t\t\t\taria-label={ contentLabel }\n\t\t\t\taria-labelledby={ contentLabel ? null : headingId }\n\t\t\t\taria-describedby={ aria.describedby }\n\t\t\t\ttabIndex=\"-1\"\n\t\t\t\t{ ...( shouldCloseOnClickOutside ? focusOutsideProps : {} ) }\n\t\t\t\tonKeyDown={ onKeyDown }\n\t\t\t>\n\t\t\t\t<div className={ 'components-modal__content' } role=\"document\">\n\t\t\t\t\t<div className=\"components-modal__header\">\n\t\t\t\t\t\t<div className=\"components-modal__header-heading-container\">\n\t\t\t\t\t\t\t{ icon && (\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclassName=\"components-modal__icon-container\"\n\t\t\t\t\t\t\t\t\taria-hidden\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ icon }\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t{ title && (\n\t\t\t\t\t\t\t\t<h1\n\t\t\t\t\t\t\t\t\tid={ headingId }\n\t\t\t\t\t\t\t\t\tclassName=\"components-modal__header-heading\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ title }\n\t\t\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{ isDismissible && (\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tonClick={ onRequestClose }\n\t\t\t\t\t\t\t\ticon={ closeSmall }\n\t\t\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\t\t\tcloseButtonLabel || __( 'Close dialog' )\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</div>\n\t\t\t\t\t{ children }\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>,\n\t\tdocument.body\n\t);\n}\n"]}