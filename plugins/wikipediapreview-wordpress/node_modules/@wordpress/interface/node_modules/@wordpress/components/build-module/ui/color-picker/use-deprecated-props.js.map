{"version":3,"sources":["@wordpress/components/src/ui/color-picker/use-deprecated-props.ts"],"names":["colorize","memoize","useCallback","useMemo","isLegacyProps","props","onChangeComplete","color","hex","getColorFromLegacyProps","toHsl","hsl","toHsv","h","s","v","a","Math","round","transformHslToLegacyColor","hsla","rawHex","toHex","rgb","toRgb","hsv","isTransparent","source","oldHue","useDeprecatedProps","onChange","enableAlpha","disableAlpha"],"mappings":"AAAA;AACA;AACA;AACA,OAAOA,QAAP,MAAuC,YAAvC,C,CACA;;AAEA,OAAOC,OAAP,MAAoB,QAApB;AAEA;AACA;AACA;;AACA,SAASC,WAAT,EAAsBC,OAAtB,QAAqC,oBAArC;AAEA;AACA;AACA;;AA8CA,SAASC,aAAT,CAAwBC,KAAxB,EAA2D;AAAA;;AAC1D,SACC,OAAOA,KAAK,CAACC,gBAAb,KAAkC,WAAlC,IACA,OAAOD,KAAK,CAACE,KAAb,KAAuB,QADvB,IAEA,wBAAOF,KAAK,CAACE,KAAb,iDAAO,aAAaC,GAApB,MAA4B,QAH7B;AAKA;;AAED,SAASC,uBAAT,CACCJ,KADD,EAEwC;AACvC,MAAK,OAAOA,KAAK,CAACE,KAAb,KAAuB,QAA5B,EAAuC;AACtC,WAAOP,QAAQ,CAAEK,KAAK,CAACE,KAAR,CAAR,CAAwBG,KAAxB,EAAP;AACA;;AAED,SAAOL,KAAK,CAACE,KAAN,CAAYI,GAAnB;AACA;;AAED,SAASC,KAAT,CACCL,KADD,EAEwC;AACvC,QAAM;AAAEM,IAAAA,CAAF;AAAKC,IAAAA,CAAL;AAAQC,IAAAA,CAAR;AAAWC,IAAAA;AAAX,MAAiBT,KAAK,CAACK,KAAN,EAAvB;AAEA,SAAO;AACNC,IAAAA,CAAC,EAAEI,IAAI,CAACC,KAAL,CAAYL,CAAZ,CADG;AAENC,IAAAA,CAAC,EAAEG,IAAI,CAACC,KAAL,CAAYJ,CAAC,GAAG,GAAhB,CAFG;AAGNC,IAAAA,CAAC,EAAEE,IAAI,CAACC,KAAL,CAAYH,CAAC,GAAG,GAAhB,CAHG;AAINC,IAAAA;AAJM,GAAP;AAMA;;AAED,MAAMG,yBAAyB,GAAGlB,OAAO,CACtCmB,IAAF,IAA+D;AAC9D,QAAMb,KAAK,GAAGP,QAAQ,CAAEoB,IAAF,CAAtB;AACA,QAAMC,MAAM,GAAGd,KAAK,CAACe,KAAN,EAAf;AACA,QAAMC,GAAG,GAAGhB,KAAK,CAACiB,KAAN,EAAZ;AACA,QAAMC,GAAG,GAAGb,KAAK,CAAEL,KAAF,CAAjB;AACA,QAAMI,GAAG,GAAGS,IAAZ;AAEA,QAAMM,aAAa,GAAGL,MAAM,KAAK,QAAX,IAAuBE,GAAG,CAACP,CAAJ,KAAU,CAAvD;AAEA,QAAMR,GAAG,GAAGkB,aAAa,GAAG,aAAH,GAAoB,IAAIL,MAAQ,EAAzD;AAEA,SAAO;AACNd,IAAAA,KADM;AAENC,IAAAA,GAFM;AAGNe,IAAAA,GAHM;AAINE,IAAAA,GAJM;AAKNd,IAAAA,GALM;AAMNgB,IAAAA,MAAM,EAAE,KANF;AAONC,IAAAA,MAAM,EAAEjB,GAAG,CAACE;AAPN,GAAP;AASA,CArBuC,CAAzC;AAwBA,OAAO,SAASgB,kBAAT,CACNxB,KADM,EAEa;AACnB,QAAMyB,QAAQ,GAAG5B,WAAW,CACzBkB,IAAF,IAAkD;AAAA;;AACjD,QAAKhB,aAAa,CAAEC,KAAF,CAAlB,EAA8B;AAC7B,aAAOA,KAAK,CAACC,gBAAN,CACNa,yBAAyB,CAAEC,IAAF,CADnB,CAAP;AAGA;;AAED,8BAAOf,KAAK,CAACyB,QAAb,oDAAO,qBAAAzB,KAAK,EAAae,IAAb,CAAZ;AACA,GAT0B,EAU3B,CACGf,KAAF,CAAyBC,gBAD1B,EAEGD,KAAF,CAA8ByB,QAF/B,CAV2B,CAA5B;AAgBA,QAAMvB,KAAK,GAAGJ,OAAO,CAAE,MAAM;AAC5B,WAAOC,aAAa,CAAEC,KAAF,CAAb,GACJI,uBAAuB,CAAEJ,KAAF,CADnB,GAEJA,KAAK,CAACE,KAFT;AAGA,GAJoB,EAIlB,CAAEF,KAAK,CAACE,KAAR,CAJkB,CAArB;AAMA,QAAMwB,WAAW,GAAG5B,OAAO,CAAE,MAAM;AAClC,WAAOC,aAAa,CAAEC,KAAF,CAAb,GACJ,CAAEA,KAAK,CAAC2B,YADJ,GAEJ3B,KAAK,CAAC0B,WAFT;AAGA,GAJ0B,EAIxB,CACA1B,KAAF,CAAyB2B,YADvB,EAEA3B,KAAF,CAA8B0B,WAF5B,CAJwB,CAA3B;AASA,SAAO,EACN,IAAK3B,aAAa,CAAEC,KAAF,CAAb,GAAyB,EAAzB,GAA8BA,KAAnC,CADM;AAENyB,IAAAA,QAFM;AAGNvB,IAAAA,KAHM;AAINwB,IAAAA;AAJM,GAAP;AAMA","sourcesContent":["/**\n * External dependencies\n */\nimport colorize, { ColorFormats } from 'tinycolor2';\n// eslint-disable-next-line no-restricted-imports\nimport type { ComponentProps } from 'react';\nimport memoize from 'memize';\n\n/**\n * WordPress dependencies\n */\nimport { useCallback, useMemo } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport type ColorPicker from './component';\n\ntype ColorPickerProps = ComponentProps< typeof ColorPicker >;\n\n/**\n * @deprecated\n */\ntype LegacyColor =\n\t| string\n\t| {\n\t\t\tcolor: colorize.Instance;\n\t\t\thex: string;\n\t\t\thsl: ColorFormats.HSL | ColorFormats.HSLA;\n\t\t\thsv: ColorFormats.HSV | ColorFormats.HSVA;\n\t\t\trgb: ColorFormats.RGB | ColorFormats.RGBA;\n\t\t\t/**\n\t\t\t * @deprecated\n\t\t\t */\n\t\t\toldHue: number;\n\t\t\t/**\n\t\t\t * @deprecated\n\t\t\t */\n\t\t\tsource: 'hex';\n\t  };\n\n/**\n * @deprecated\n */\nexport interface LegacyProps {\n\tcolor: LegacyColor;\n\t/**\n\t * @deprecated\n\t */\n\tonChangeComplete: ( colors: LegacyColor ) => void;\n\t/**\n\t * @deprecated\n\t */\n\toldHue: string;\n\tclassName: string;\n\t/**\n\t * @deprecated\n\t */\n\tdisableAlpha: boolean;\n}\n\nfunction isLegacyProps( props: any ): props is LegacyProps {\n\treturn (\n\t\ttypeof props.onChangeComplete !== 'undefined' ||\n\t\ttypeof props.color === 'string' ||\n\t\ttypeof props.color?.hex === 'string'\n\t);\n}\n\nfunction getColorFromLegacyProps(\n\tprops: LegacyProps\n): ColorFormats.HSL | ColorFormats.HSLA {\n\tif ( typeof props.color === 'string' ) {\n\t\treturn colorize( props.color ).toHsl();\n\t}\n\n\treturn props.color.hsl;\n}\n\nfunction toHsv(\n\tcolor: colorize.Instance\n): ColorFormats.HSV | ColorFormats.HSVA {\n\tconst { h, s, v, a } = color.toHsv();\n\n\treturn {\n\t\th: Math.round( h ),\n\t\ts: Math.round( s * 100 ),\n\t\tv: Math.round( v * 100 ),\n\t\ta,\n\t};\n}\n\nconst transformHslToLegacyColor = memoize(\n\t( hsla: ColorFormats.HSL | ColorFormats.HSLA ): LegacyColor => {\n\t\tconst color = colorize( hsla );\n\t\tconst rawHex = color.toHex();\n\t\tconst rgb = color.toRgb();\n\t\tconst hsv = toHsv( color );\n\t\tconst hsl = hsla;\n\n\t\tconst isTransparent = rawHex === '000000' && rgb.a === 0;\n\n\t\tconst hex = isTransparent ? 'transparent' : `#${ rawHex }`;\n\n\t\treturn {\n\t\t\tcolor,\n\t\t\thex,\n\t\t\trgb,\n\t\t\thsv,\n\t\t\thsl,\n\t\t\tsource: 'hex',\n\t\t\toldHue: hsl.h,\n\t\t};\n\t}\n);\n\nexport function useDeprecatedProps(\n\tprops: LegacyProps | ColorPickerProps\n): ColorPickerProps {\n\tconst onChange = useCallback(\n\t\t( hsla: ColorFormats.HSL | ColorFormats.HSLA ) => {\n\t\t\tif ( isLegacyProps( props ) ) {\n\t\t\t\treturn props.onChangeComplete(\n\t\t\t\t\ttransformHslToLegacyColor( hsla )\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn props.onChange?.( hsla );\n\t\t},\n\t\t[\n\t\t\t( props as LegacyProps ).onChangeComplete,\n\t\t\t( props as ColorPickerProps ).onChange,\n\t\t]\n\t);\n\n\tconst color = useMemo( () => {\n\t\treturn isLegacyProps( props )\n\t\t\t? getColorFromLegacyProps( props )\n\t\t\t: props.color;\n\t}, [ props.color ] );\n\n\tconst enableAlpha = useMemo( () => {\n\t\treturn isLegacyProps( props )\n\t\t\t? ! props.disableAlpha\n\t\t\t: props.enableAlpha;\n\t}, [\n\t\t( props as LegacyProps ).disableAlpha,\n\t\t( props as ColorPickerProps ).enableAlpha,\n\t] );\n\n\treturn {\n\t\t...( isLegacyProps( props ) ? {} : props ),\n\t\tonChange,\n\t\tcolor,\n\t\tenableAlpha,\n\t};\n}\n"]}